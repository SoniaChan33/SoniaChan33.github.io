<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"www.shan33.cn","root":"/","images":"/images","scheme":"Mist","darkmode":false,"version":"8.11.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="引入1.数据库基本概念1.1 数据所谓数据（Data）是指对客观事物进行描述并可以鉴别的符号，这些符号是可识别的、抽象的。它不仅仅指狭义上的数字，而是有多种表现形式：字母、文字、文本、图形、音频、视频等。现在计算机存储和处理的数据范围十分广泛，而描述这些数据的符号也变得越来越复杂了。 1.2 数据库数据库（Database，DB）指的是以一定格式存放、能够实现多个用户共享、与应用程序彼此独立的数据">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL">
<meta property="og:url" content="http://www.shan33.cn/2021/05/07/MySQL/index.html">
<meta property="og:site_name" content="Sonia33&#39;s Blog">
<meta property="og:description" content="引入1.数据库基本概念1.1 数据所谓数据（Data）是指对客观事物进行描述并可以鉴别的符号，这些符号是可识别的、抽象的。它不仅仅指狭义上的数字，而是有多种表现形式：字母、文字、文本、图形、音频、视频等。现在计算机存储和处理的数据范围十分广泛，而描述这些数据的符号也变得越来越复杂了。 1.2 数据库数据库（Database，DB）指的是以一定格式存放、能够实现多个用户共享、与应用程序彼此独立的数据">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://www.shan33.cn/2021/05/07/MySQL/20210630201735.png">
<meta property="og:image" content="http://www.shan33.cn/2021/05/07/MySQL/20210630201859.png">
<meta property="og:image" content="http://www.shan33.cn/2021/05/07/MySQL/20210701085258.png">
<meta property="og:image" content="http://www.shan33.cn/2021/05/07/MySQL/20210701105406.png">
<meta property="og:image" content="http://www.shan33.cn/2021/05/07/MySQL/20210701111051.png">
<meta property="og:image" content="http://www.shan33.cn/2021/05/07/MySQL/20210701112307.png">
<meta property="og:image" content="http://www.shan33.cn/2021/05/07/MySQL/20210701112344.png">
<meta property="og:image" content="http://www.shan33.cn/2021/05/07/MySQL/20210701113031.png">
<meta property="og:image" content="http://www.shan33.cn/2021/05/07/MySQL/20210701142452.png">
<meta property="og:image" content="http://www.shan33.cn/2021/05/07/MySQL/20210701142510.png">
<meta property="og:image" content="http://www.shan33.cn/2021/05/07/MySQL/20210701143713.png">
<meta property="og:image" content="http://www.shan33.cn/2021/05/07/MySQL/20210701143726.png">
<meta property="og:image" content="http://www.shan33.cn/2021/05/07/MySQL/20210701143737.png">
<meta property="og:image" content="http://www.shan33.cn/2021/05/07/MySQL/20210701143749.png">
<meta property="og:image" content="http://www.shan33.cn/2021/05/07/MySQL/20210630210116.png">
<meta property="og:image" content="http://www.shan33.cn/2021/05/07/MySQL/20210630210456.png">
<meta property="og:image" content="http://www.shan33.cn/2021/05/07/MySQL/20210630223758.png">
<meta property="og:image" content="http://www.shan33.cn/2021/05/07/MySQL/20210630223819.png">
<meta property="og:image" content="http://www.shan33.cn/2021/05/07/MySQL/20210630223829.png">
<meta property="og:image" content="http://www.shan33.cn/2021/05/07/MySQL/20210630224323.png">
<meta property="og:image" content="http://www.shan33.cn/2021/05/07/MySQL/20210630224430.png">
<meta property="og:image" content="http://www.shan33.cn/2021/05/07/MySQL/20210630224453.png">
<meta property="og:image" content="http://www.shan33.cn/2021/05/07/MySQL/20210630224611.png">
<meta property="og:image" content="http://www.shan33.cn/2021/05/07/MySQL/20210701170246.png">
<meta property="og:image" content="http://www.shan33.cn/2021/05/07/MySQL/20210701163643.png">
<meta property="og:image" content="http://www.shan33.cn/2021/05/07/MySQL/20210701170831.png">
<meta property="og:image" content="http://www.shan33.cn/2021/05/07/MySQL/20210701171121.png">
<meta property="og:image" content="http://www.shan33.cn/2021/05/07/MySQL/20210701184545.png">
<meta property="og:image" content="http://www.shan33.cn/2021/05/07/MySQL/20210702094750.png">
<meta property="og:image" content="http://www.shan33.cn/2021/05/07/MySQL/20210703110321.png">
<meta property="og:image" content="http://www.shan33.cn/2021/05/07/MySQL/20210703111005.png">
<meta property="og:image" content="http://www.shan33.cn/2021/05/07/MySQL/20210703111018.png">
<meta property="og:image" content="http://www.shan33.cn/2021/05/07/MySQL/20210703111036.png">
<meta property="og:image" content="http://www.shan33.cn/2021/05/07/MySQL/20210703142738.png">
<meta property="og:image" content="http://www.shan33.cn/2021/05/07/MySQL/20210703152258.png">
<meta property="og:image" content="http://www.shan33.cn/2021/05/07/MySQL/05/07/MySQL/20210703152314.png">
<meta property="og:image" content="http://www.shan33.cn/2021/05/07/MySQL/20210703152514.png">
<meta property="og:image" content="http://www.shan33.cn/2021/05/07/MySQL/20210703152552.png">
<meta property="og:image" content="http://www.shan33.cn/2021/05/07/MySQL/20210703152939.png">
<meta property="og:image" content="http://www.shan33.cn/2021/05/07/MySQL/20210703161609.png">
<meta property="og:image" content="http://www.shan33.cn/2021/05/07/MySQL/20210703161731.png">
<meta property="og:image" content="http://www.shan33.cn/2021/05/07/MySQL/20210703162005.png">
<meta property="og:image" content="http://www.shan33.cn/2021/05/07/MySQL/20210703171452.png">
<meta property="og:image" content="http://www.shan33.cn/2021/05/07/MySQL/20210703191518.png">
<meta property="article:published_time" content="2021-05-07T01:21:10.000Z">
<meta property="article:modified_time" content="2022-05-16T02:48:31.748Z">
<meta property="article:author" content="Sonia33">
<meta property="article:tag" content="DataBase">
<meta property="article:tag" content="MySQL">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://www.shan33.cn/2021/05/07/MySQL/20210630201735.png">


<link rel="canonical" href="http://www.shan33.cn/2021/05/07/MySQL/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://www.shan33.cn/2021/05/07/MySQL/","path":"2021/05/07/MySQL/","title":"MySQL"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>MySQL | Sonia33's Blog</title>
  




<link rel="stylesheet" type="text/css" href="/css/injector/main.css" /><link rel="preload" as="style" href="/css/injector/light.css" /><link rel="preload" as="style" href="/css/injector/dark.css" />
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="Sonia33's Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Sonia33's Blog</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%BC%95%E5%85%A5"><span class="nav-number">1.</span> <span class="nav-text">引入</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="nav-number">1.1.</span> <span class="nav-text">1.数据库基本概念</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-%E6%95%B0%E6%8D%AE"><span class="nav-number">1.1.1.</span> <span class="nav-text">1.1 数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-number">1.1.2.</span> <span class="nav-text">1.2 数据库</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F"><span class="nav-number">1.1.3.</span> <span class="nav-text">1.3 数据库管理系统</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-4%E6%95%B0%E6%8D%AE%E5%BA%93%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F"><span class="nav-number">1.1.4.</span> <span class="nav-text">1.4数据库应用程序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-5-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%A1%E7%90%86%E5%91%98"><span class="nav-number">1.1.5.</span> <span class="nav-text">1.5 数据库管理员</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-6-%E6%9C%80%E7%BB%88%E7%94%A8%E6%88%B7"><span class="nav-number">1.1.6.</span> <span class="nav-text">1.6 最终用户</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-7-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F"><span class="nav-number">1.1.7.</span> <span class="nav-text">1.7 数据库系统</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A1%A8%E5%88%97%E7%B1%BB%E5%9E%8B"><span class="nav-number">1.2.</span> <span class="nav-text">2. 数据库表列类型</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-%E6%95%B4%E6%95%B0%E7%B1%BB%E5%9E%8B"><span class="nav-number">1.2.1.</span> <span class="nav-text">2.1 整数类型</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%A1%A8%E7%9A%84%E5%AE%8C%E6%95%B4%E6%80%A7%E7%BA%A6%E6%9D%9F"><span class="nav-number">2.</span> <span class="nav-text">表的完整性约束</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E9%9D%9E%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F"><span class="nav-number">2.1.</span> <span class="nav-text">1. 非外键约束</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AE%9E%E4%BE%8B%E4%B8%80%EF%BC%9A%E5%BB%BA%E7%AB%8B%E4%B8%80%E5%BC%A0%E7%94%A8%E6%9D%A5%E5%AD%98%E5%82%A8%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E7%9A%84%E8%A1%A8"><span class="nav-number">2.1.0.0.1.</span> <span class="nav-text">实例一：建立一张用来存储学生信息的表</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%97%E7%BA%A7%E7%BA%A6%E6%9D%9F%E5%92%8C%E8%A1%A8%E7%BA%A7%E7%BA%A6%E6%9D%9F"><span class="nav-number">2.1.0.1.</span> <span class="nav-text">- 列级约束和表级约束</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AE%9E%E4%BE%8B%E4%BA%8C"><span class="nav-number">2.1.0.1.1.</span> <span class="nav-text">实例二</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E8%A1%A8%E4%B9%8B%E5%90%8E%E6%B7%BB%E5%8A%A0%E7%BA%A6%E6%9D%9F"><span class="nav-number">2.1.0.2.</span> <span class="nav-text">- 创建表之后添加约束</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AE%9E%E4%BE%8B%E4%B8%89"><span class="nav-number">2.1.0.2.1.</span> <span class="nav-text">实例三</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F"><span class="nav-number">2.2.</span> <span class="nav-text">2. 外键约束</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AE%9E%E4%BE%8B%E5%9B%9B"><span class="nav-number">2.2.0.0.1.</span> <span class="nav-text">实例四</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%96%E9%94%AE%E7%AD%96%E7%95%A5%EF%BC%9A"><span class="nav-number">2.2.0.1.</span> <span class="nav-text">外键策略：</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E7%AD%96%E7%95%A5%E4%B8%80%EF%BC%9Ano-action-%E4%B8%8D%E5%85%81%E8%AE%B8%E6%93%8D%E4%BD%9C"><span class="nav-number">2.2.0.1.0.1.</span> <span class="nav-text">策略一：no action 不允许操作</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E7%AD%96%E7%95%A5%E4%BA%8C%EF%BC%9A%E4%BD%BF%E7%94%A8cascade%E7%BA%A7%E8%81%94%E6%93%8D%E4%BD%9C"><span class="nav-number">2.2.0.1.0.2.</span> <span class="nav-text">策略二：使用cascade级联操作</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E7%AD%96%E7%95%A5%E4%B8%89%EF%BC%9Aset-null-%E7%BD%AE%E7%A9%BA%E6%93%8D%E4%BD%9C"><span class="nav-number">2.2.0.1.0.3.</span> <span class="nav-text">策略三：set null     置空操作</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#DQL%E6%9F%A5%E8%AF%A2%E6%93%8D%E4%BD%9C"><span class="nav-number">3.</span> <span class="nav-text">DQL查询操作*</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E5%B8%B8%E8%A7%81%E8%A1%A8%E7%9A%84%E5%87%86%E5%A4%87"><span class="nav-number">3.1.</span> <span class="nav-text">1. 常见表的准备</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%83%A8%E9%97%A8%E8%A1%A8-dept"><span class="nav-number">3.1.1.</span> <span class="nav-text">部门表(dept)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%91%98%E5%B7%A5%E8%A1%A8%EF%BC%88emp"><span class="nav-number">3.1.2.</span> <span class="nav-text">员工表（emp)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%96%AA%E8%B5%84%E7%99%BB%E8%AE%B0%E8%A1%A8-salgrade"><span class="nav-number">3.1.3.</span> <span class="nav-text">薪资登记表(salgrade)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A5%96%E9%87%91%E8%A1%A8-bonus"><span class="nav-number">3.1.4.</span> <span class="nav-text">奖金表(bonus)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%93%8D%E4%BD%9C"><span class="nav-number">3.1.5.</span> <span class="nav-text">操作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%93%E6%9E%9C-%E8%A1%A8%E6%A0%BC%E5%BD%A2%E5%BC%8F"><span class="nav-number">3.1.6.</span> <span class="nav-text">结果(表格形式)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E5%8D%95%E8%A1%A8%E6%9F%A5%E8%AF%A2"><span class="nav-number">3.2.</span> <span class="nav-text">2.  单表查询</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-%E7%AE%80%E5%8D%95%E7%9A%84SQL%E6%9F%A5%E8%AF%A2"><span class="nav-number">3.2.1.</span> <span class="nav-text">2.1 简单的SQL查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-where%E5%AD%90%E5%8F%A5"><span class="nav-number">3.2.2.</span> <span class="nav-text">2.2 where子句</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-%E5%87%BD%E6%95%B0"><span class="nav-number">3.2.3.</span> <span class="nav-text">2.3 函数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8D%95%E8%A1%8C%E5%87%BD%E6%95%B0"><span class="nav-number">3.2.3.1.</span> <span class="nav-text">- 单行函数</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%87%BD%E6%95%B0"><span class="nav-number">3.2.3.1.1.</span> <span class="nav-text">1. 字符串函数</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-%E6%95%B0%E5%80%BC%E5%87%BD%E6%95%B0"><span class="nav-number">3.2.3.1.2.</span> <span class="nav-text">2. 数值函数</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-%E6%97%A5%E6%9C%9F%E4%B8%8E%E6%97%B6%E9%97%B4%E5%87%BD%E6%95%B0"><span class="nav-number">3.2.3.1.3.</span> <span class="nav-text">3. 日期与时间函数</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#4-%E6%B5%81%E7%A8%8B%E5%87%BD%E6%95%B0"><span class="nav-number">3.2.3.1.4.</span> <span class="nav-text">4. 流程函数</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-JSON%E5%87%BD%E6%95%B0"><span class="nav-number">3.2.3.1.5.</span> <span class="nav-text">5. JSON函数</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#6-%E5%85%B6%E4%BB%96%E5%87%BD%E6%95%B0"><span class="nav-number">3.2.3.1.6.</span> <span class="nav-text">6. 其他函数</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%9A%E8%A1%8C%E5%87%BD%E6%95%B0"><span class="nav-number">3.2.3.2.</span> <span class="nav-text">- 多行函数</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-4-%E5%88%86%E7%BB%84%E4%B8%8E%E7%AD%9B%E9%80%89"><span class="nav-number">3.2.4.</span> <span class="nav-text">2.4 分组与筛选</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#group-by-%E5%88%86%E7%BB%84"><span class="nav-number">3.2.4.1.</span> <span class="nav-text">group by 分组</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#having-%E5%88%86%E7%BB%84%E5%90%8E%E7%AD%9B%E9%80%89"><span class="nav-number">3.2.4.2.</span> <span class="nav-text">having 分组后筛选</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-number">3.2.5.</span> <span class="nav-text">总结</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-select%E8%AF%AD%E5%8F%A5%E6%80%BB%E7%BB%93"><span class="nav-number">3.2.5.1.</span> <span class="nav-text">[1] select语句总结</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-select%E8%AF%AD%E5%8F%A5%E7%9A%84%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F"><span class="nav-number">3.2.5.2.</span> <span class="nav-text">[2] select语句的执行顺序</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-%E5%8D%95%E8%A1%A8%E6%9F%A5%E8%AF%A2%E7%BB%83%E4%B9%A0"><span class="nav-number">3.2.5.3.</span> <span class="nav-text">[3] 单表查询练习</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2"><span class="nav-number">3.3.</span> <span class="nav-text">3.  多表查询</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-%E4%BA%A4%E5%8F%89%E8%BF%9E%E6%8E%A5-cross-join"><span class="nav-number">3.3.1.</span> <span class="nav-text">3.1  交叉连接 cross join</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-%E8%87%AA%E7%84%B6%E8%BF%9E%E6%8E%A5-natural"><span class="nav-number">3.3.2.</span> <span class="nav-text">3.2  自然连接 natural</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-%E5%86%85%E8%BF%9E%E6%8E%A5-inner-join"><span class="nav-number">3.3.3.</span> <span class="nav-text">3.3 内连接 inner join</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-%E5%A4%96%E8%BF%9E%E6%8E%A5-outer-join"><span class="nav-number">3.3.4.</span> <span class="nav-text">3.4 外连接  outer  join</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%B7%A6%E5%A4%96%E8%BF%9E%E6%8E%A5"><span class="nav-number">3.3.4.0.1.</span> <span class="nav-text">左外连接</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8F%B3%E5%A4%96%E8%BF%9E%E6%8E%A5"><span class="nav-number">3.3.4.0.2.</span> <span class="nav-text">右外连接</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%85%A8%E5%A4%96%E8%BF%9E%E6%8E%A5"><span class="nav-number">3.3.4.0.3.</span> <span class="nav-text">全外连接</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%B9%B6%E9%9B%86-union"><span class="nav-number">3.3.4.0.3.1.</span> <span class="nav-text">并集 union</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#union-all"><span class="nav-number">3.3.4.0.3.2.</span> <span class="nav-text">union all</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-5-%E4%B8%89%E8%A1%A8%E6%9F%A5%E8%AF%A2"><span class="nav-number">3.3.5.</span> <span class="nav-text">3.5 三表查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-6-%E8%87%AA%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="nav-number">3.3.6.</span> <span class="nav-text">3.6 自连接查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A1%A5%E5%85%85%EF%BC%9A92%E8%AF%AD%E6%B3%95%E7%9A%84%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2"><span class="nav-number">3.3.7.</span> <span class="nav-text">补充：92语法的多表查询</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-%E4%B8%8D%E7%9B%B8%E5%85%B3%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="nav-number">3.4.</span> <span class="nav-text">4. 不相关子查询</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BC%95%E5%85%A5-1"><span class="nav-number">3.4.1.</span> <span class="nav-text">引入</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-%E5%8D%95%E8%A1%8C%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="nav-number">3.4.2.</span> <span class="nav-text">4.1  单行子查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-%E5%A4%9A%E8%A1%8C%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="nav-number">3.4.3.</span> <span class="nav-text">4.2  多行子查询</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AE%9E%E4%BE%8B%E4%B8%80"><span class="nav-number">3.4.3.0.1.</span> <span class="nav-text">实例一</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AE%9E%E4%BE%8B%E4%BA%8C-1"><span class="nav-number">3.4.3.0.2.</span> <span class="nav-text">实例二</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AE%9E%E4%BE%8B%E4%B8%89-1"><span class="nav-number">3.4.3.0.3.</span> <span class="nav-text">实例三</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-%E7%9B%B8%E5%85%B3%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="nav-number">3.5.</span> <span class="nav-text">5. 相关子查询</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BC%95%E5%85%A5-2"><span class="nav-number">3.5.1.</span> <span class="nav-text">引入</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9E%E4%BE%8B"><span class="nav-number">3.5.2.</span> <span class="nav-text">实例</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AF%B9%E8%B1%A1"><span class="nav-number">4.</span> <span class="nav-text">数据库对象</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E4%BA%8B%E5%8A%A1"><span class="nav-number">4.1.</span> <span class="nav-text">1. 事务</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A6%82%E5%BF%B5"><span class="nav-number">4.1.0.1.</span> <span class="nav-text">概念</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%89%B9%E6%80%A7"><span class="nav-number">4.1.0.2.</span> <span class="nav-text">特性</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AE%9E%E4%BE%8B%EF%BC%9A%E4%BD%BF%E7%94%A8%E4%BA%8B%E5%8A%A1%E4%BF%9D%E8%AF%81%E8%BD%AC%E8%B4%A6%E5%AE%89%E5%85%A8"><span class="nav-number">4.1.0.2.1.</span> <span class="nav-text">实例：使用事务保证转账安全</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8B%E5%8A%A1%E5%B9%B6%E5%8F%91%E9%97%AE%E9%A2%98"><span class="nav-number">4.1.1.</span> <span class="nav-text">事务并发问题</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%84%8F%E8%AF%BB%EF%BC%88Dirty-read%EF%BC%89"><span class="nav-number">4.1.1.0.1.</span> <span class="nav-text">脏读（Dirty read）</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%B8%8D%E5%8F%AF%E9%87%8D%E5%A4%8D%E8%AF%BB-%EF%BC%88Unrepeatableread%EF%BC%89"><span class="nav-number">4.1.1.0.2.</span> <span class="nav-text">不可重复读 （Unrepeatableread）</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%B9%BB%E8%AF%BB-%EF%BC%88Phantom-read%EF%BC%89"><span class="nav-number">4.1.1.0.3.</span> <span class="nav-text">幻读 （Phantom read）</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB"><span class="nav-number">4.1.2.</span> <span class="nav-text">事务隔离级别</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AE%9E%E4%BE%8B-1"><span class="nav-number">4.1.2.0.1.</span> <span class="nav-text">实例</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E8%A7%86%E5%9B%BE"><span class="nav-number">4.2.</span> <span class="nav-text">2. 视图</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A6%82%E5%BF%B5-1"><span class="nav-number">4.2.0.1.</span> <span class="nav-text">概念</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BC%98%E7%82%B9"><span class="nav-number">4.2.0.2.</span> <span class="nav-text">优点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9E%E4%BE%8B%E4%B8%80%EF%BC%9A%E5%8D%95%E8%A1%A8%E8%A7%86%E5%9B%BE"><span class="nav-number">4.2.0.3.</span> <span class="nav-text">实例一：单表视图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9E%E4%BE%8B%E4%BA%8C%EF%BC%9A%E5%A4%9A%E8%A1%A8%E8%A7%86%E5%9B%BE"><span class="nav-number">4.2.0.4.</span> <span class="nav-text">实例二：多表视图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9E%E4%BE%8B%E4%B8%89%EF%BC%9A%E7%BB%9F%E8%AE%A1%E8%A7%86%E5%9B%BE"><span class="nav-number">4.2.0.5.</span> <span class="nav-text">实例三：统计视图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9E%E4%BE%8B%E5%9B%9B%EF%BC%9A%E5%9F%BA%E4%BA%8E%E8%A7%86%E5%9B%BE%E7%9A%84%E8%A7%86%E5%9B%BE"><span class="nav-number">4.2.0.6.</span> <span class="nav-text">实例四：基于视图的视图</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="nav-number">4.3.</span> <span class="nav-text">3. 存储过程</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A6%82%E5%BF%B5-2"><span class="nav-number">4.3.0.1.</span> <span class="nav-text">概念</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BC%98%E7%82%B9-1"><span class="nav-number">4.3.0.2.</span> <span class="nav-text">优点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9E%E4%BE%8B-2"><span class="nav-number">4.3.0.3.</span> <span class="nav-text">实例</span></a></li></ol></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Sonia33"
      src="/images/iu.png">
  <p class="site-author-name" itemprop="name">Sonia33</p>
  <div class="site-description" itemprop="description">不念过去，不惧未来</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">17</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">29</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/soniachan33" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;soniachan33" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:soniachan33@163.com" title="E-Mail → mailto:soniachan33@163.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://blog.csdn.net/weixin_43633620?spm=1000.2115.3001.5343" title="CSDN → https:&#x2F;&#x2F;blog.csdn.net&#x2F;weixin_43633620?spm&#x3D;1000.2115.3001.5343" rel="noopener" target="_blank"><i class="fa fa-book-open fa-fw"></i>CSDN</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://space.bilibili.com/360939620" title="bilibili → https:&#x2F;&#x2F;space.bilibili.com&#x2F;360939620" rel="noopener" target="_blank"><i class="fab fa-youtube fa-fw"></i>bilibili</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/u/5160074037" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;u&#x2F;5160074037" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://www.shan33.cn/2021/05/07/MySQL/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/iu.png">
      <meta itemprop="name" content="Sonia33">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sonia33's Blog">
      <meta itemprop="description" content="不念过去，不惧未来">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="MySQL | Sonia33's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          MySQL
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-05-07 09:21:10" itemprop="dateCreated datePublished" datetime="2021-05-07T09:21:10+08:00">2021-05-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-05-16 10:48:31" itemprop="dateModified" datetime="2022-05-16T10:48:31+08:00">2022-05-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">笔记</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h1 id="引入"><a href="#引入" class="headerlink" title="引入"></a>引入</h1><h2 id="1-数据库基本概念"><a href="#1-数据库基本概念" class="headerlink" title="1.数据库基本概念"></a>1.数据库基本概念</h2><h3 id="1-1-数据"><a href="#1-1-数据" class="headerlink" title="1.1 数据"></a>1.1 数据</h3><p>所谓数据（Data）是指对客观事物进行描述并可以鉴别的符号，这些符号是可识别的、抽象的。它不仅仅指狭义上的数字，而是有多种表现形式：字母、文字、文本、图形、音频、视频等。现在计算机存储和处理的数据范围十分广泛，而描述这些数据的符号也变得越来越复杂了。</p>
<h3 id="1-2-数据库"><a href="#1-2-数据库" class="headerlink" title="1.2 数据库"></a>1.2 数据库</h3><p>数据库（Database，DB）指的是以一定格式存放、能够实现多个用户共享、与应用程序彼此独立的数据集合。</p>
<span id="more"></span>

<h3 id="1-3-数据库管理系统"><a href="#1-3-数据库管理系统" class="headerlink" title="1.3 数据库管理系统"></a>1.3 数据库管理系统</h3><p>数据库管理系统（Database Management System，DBMS）是用来定义和管理数据的软件。如何科学的组织和存储数据，如何高效的获取和维护数据，如何保证数据的安全性和完整性，这些都需要靠数据库管理系统完成。目前，比较流行的数据库管理系统有：Oracle、MySQL、SQL Server、DB2等。</p>
<h3 id="1-4数据库应用程序"><a href="#1-4数据库应用程序" class="headerlink" title="1.4数据库应用程序"></a>1.4数据库应用程序</h3><p>数据库应用程序（Database Application System，DBAS）是在数据库管理系统基础上，使用数据库管理系统的语法，开发的直接面对最终用户的应用程序，如学生管理系统、人事管理系统、图书管理系统等。</p>
<h3 id="1-5-数据库管理员"><a href="#1-5-数据库管理员" class="headerlink" title="1.5 数据库管理员"></a>1.5 数据库管理员</h3><p>数据库管理员（Database Administrator，DBA）是指对数据库管理系统进行操作的人员，其主要负责数据库的运营和维护。</p>
<h3 id="1-6-最终用户"><a href="#1-6-最终用户" class="headerlink" title="1.6 最终用户"></a>1.6 最终用户</h3><p>最终用户（User）指的是数据库应用程序的使用者。用户面向的是数据库应用程序（通过应用程序操作数据），并不会直接与数据库打交道。</p>
<h3 id="1-7-数据库系统"><a href="#1-7-数据库系统" class="headerlink" title="1.7 数据库系统"></a>1.7 数据库系统</h3><p>数据库系统（Database System，DBS）一般是由数据库、数据库管理系统、数据库应用程序、数据库管理员和最终用户构成。其中DBMS是数据库系统的基础和核心</p>
<h2 id="2-数据库表列类型"><a href="#2-数据库表列类型" class="headerlink" title="2. 数据库表列类型"></a>2. 数据库表列类型</h2><h3 id="2-1-整数类型"><a href="#2-1-整数类型" class="headerlink" title="2.1 整数类型"></a>2.1 整数类型</h3><img src="/2021/05/07/MySQL/20210630201735.png" alt="image-20210630201735014" style="zoom:67%;">

<ol>
<li><p>MySQL支持选择在该类型关键字后面的括号内指定整数值的<strong>显示宽度</strong>(例如，INT(4))。显示宽度并不限制可以在列内保存的值的范围，也不限制超过列的指定宽度的值的显示</p>
</li>
<li><p>主键自增：不使用序列，通过<strong>auto_increment</strong>，要求是<strong>整数类型</strong></p>
</li>
<li><p>支持选择在该类型关键字后面的括号内指定整数值的显示宽度</p>
</li>
</ol>
<img src="/2021/05/07/MySQL/20210630201859.png" alt="image-20210630201859642" style="zoom:67%;">







<h1 id="表的完整性约束"><a href="#表的完整性约束" class="headerlink" title="表的完整性约束"></a>表的完整性约束</h1><h2 id="1-非外键约束"><a href="#1-非外键约束" class="headerlink" title="1. 非外键约束"></a>1. 非外键约束</h2><table>
<thead>
<tr>
<th><strong>约束条件</strong></th>
<th><strong>约束描述</strong></th>
</tr>
</thead>
<tbody><tr>
<td>PRIMARY KEY</td>
<td>主键约束，约束字段的值可唯一地标识对应的记录</td>
</tr>
<tr>
<td>NOT NULL</td>
<td>非空约束，约束字段的值不能为空</td>
</tr>
<tr>
<td>UNIQUE</td>
<td>唯一约束，约束字段的值是唯一的</td>
</tr>
<tr>
<td>CHECK</td>
<td>检查约束，限制某个字段的取值范围</td>
</tr>
<tr>
<td>DEFAULT</td>
<td>默认值约束，约束字段的默认值</td>
</tr>
<tr>
<td>AUTO_INCREMENT</td>
<td>自动增加约束，约束字段的值自动递增</td>
</tr>
<tr>
<td>FOREIGN KEY</td>
<td>外键约束，约束表与表之间的关系</td>
</tr>
</tbody></table>
<h5 id="实例一：建立一张用来存储学生信息的表"><a href="#实例一：建立一张用来存储学生信息的表" class="headerlink" title="实例一：建立一张用来存储学生信息的表"></a><strong>实例一</strong>：建立一张用来存储学生信息的表</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line">建立一张用来存储学生信息的表</span><br><span class="line">字段包含学号、姓名、性别，年龄、入学日期、班级，email等信息</span><br><span class="line">约束：</span><br><span class="line">建立一张用来存储学生信息的表</span><br><span class="line">字段包含学号、姓名、性别，年龄、入学日期、班级，email等信息</span><br><span class="line">【1】学号是主键 = 不能为空 +  唯一 ，主键的作用：可以通过主键查到唯一的一条记录【2】如果主键是整数类型，那么需要自增</span><br><span class="line">【3】姓名不能为空</span><br><span class="line">【4】Email唯一</span><br><span class="line">【5】性别默认值是男</span><br><span class="line">【6】性别只能是男女</span><br><span class="line">【7】年龄只能在18-50之间</span><br><span class="line">*/</span><br><span class="line">-- 创建数据库表：</span><br><span class="line">create table t_student(</span><br><span class="line">        sno int(6) primary key auto_increment, -- 主键自增</span><br><span class="line">        sname varchar(5) not null, </span><br><span class="line">        sex char(1) default &#x27;男&#x27; check(sex=&#x27;男&#x27; || sex=&#x27;女&#x27;),</span><br><span class="line">        age int(3) check(age&gt;=18 and age&lt;=50),</span><br><span class="line">        enterdate date,</span><br><span class="line">        classname varchar(10),</span><br><span class="line">        email varchar(15) unique -- 唯一</span><br><span class="line">);</span><br><span class="line">-- 查看数据：</span><br><span class="line">select * from t_student;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<img src="/2021/05/07/MySQL/20210701085258.png" alt="image-20210701085258650" style="zoom:67%;">

<ul>
<li><p>添加数据：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">-- 添加数据：</span><br><span class="line">--  1048 - Column &#x27;sname&#x27; cannot be null 不能为null</span><br><span class="line">-- 3819 - Check constraint &#x27;t_student_chk_1&#x27; is violated. 违反检查约束</span><br><span class="line">insert into t_student values (1,&#x27;张三&#x27;,&#x27;男&#x27;,21,&#x27;2023-9-1&#x27;,&#x27;java01班&#x27;,&#x27;zs@126.com&#x27;);</span><br><span class="line">-- 1062 - Duplicate entry &#x27;1&#x27; for key &#x27;t_student.PRIMARY&#x27; 主键重复</span><br><span class="line">-- &gt; 1062 - Duplicate entry &#x27;ls@126.com&#x27; for key &#x27;t_student.email&#x27; 违反唯一约束</span><br><span class="line">insert into t_student values (2,&#x27;李四&#x27;,&#x27;男&#x27;,21,&#x27;2023-9-1&#x27;,&#x27;java01班&#x27;,&#x27;ls@126.com&#x27;);</span><br><span class="line">insert into t_student values (3,&#x27;露露&#x27;,&#x27;男&#x27;,21,&#x27;2023-9-1&#x27;,&#x27;java01班&#x27;,&#x27;ls@126.com&#x27;);</span><br><span class="line">-- 如果主键没有设定值，或者用null.default都可以完成主键自增的效果</span><br><span class="line">insert into t_student (sname,enterdate) values (&#x27;菲菲&#x27;,&#x27;2029-4-5&#x27;);</span><br><span class="line">insert into t_student values (null,&#x27;小明&#x27;,&#x27;男&#x27;,21,&#x27;2023-9-1&#x27;,&#x27;java01班&#x27;,&#x27;xm@126.com&#x27;);</span><br><span class="line">insert into t_student values (default,&#x27;小刚&#x27;,&#x27;男&#x27;,21,&#x27;2023-9-1&#x27;,&#x27;java01班&#x27;,&#x27;xg@126.com&#x27;);</span><br><span class="line">-- 如果sql报错，可能主键就浪费了，后续插入的主键是不连号的，我们主键也不要求连号的</span><br><span class="line">insert into t_student values (null,&#x27;小明&#x27;,&#x27;男&#x27;,21,&#x27;2023-9-1&#x27;,&#x27;java01班&#x27;,&#x27;oo@126.com&#x27;);</span><br></pre></td></tr></table></figure>

<p><strong>常见错误：</strong></p>
<p>  –》 1048 - Column ‘sname’ cannot be null <strong>不能为null</strong></p>
<p>  –》 819 - Check constraint ‘t_student_chk_1’ is violated. <strong>违反检查约束</strong></p>
<p>  – 》1062 - Duplicate（重复的） entry ‘1’ for key ‘t_student.PRIMARY’ <strong>主键重复</strong></p>
<p>  – 》1062 - Duplicate entry ‘<a href="mailto:&#108;&#115;&#x40;&#x31;&#50;&#x36;&#46;&#99;&#x6f;&#109;">&#108;&#115;&#x40;&#x31;&#50;&#x36;&#46;&#99;&#x6f;&#109;</a>‘ for key ‘t_student.email’ <strong>违反唯一约束</strong></p>
<ul>
<li>使用自增的时候用<strong>null和default</strong>都是可以</li>
<li>如果sql报错，可能<strong>主键</strong>就浪费了，后续插入的主键是不连号的，主键也不要求连号的</li>
</ul>
</li>
</ul>
<h4 id="列级约束和表级约束"><a href="#列级约束和表级约束" class="headerlink" title="- 列级约束和表级约束"></a>- 列级约束和表级约束</h4><p>(1)   <strong>表级约束</strong>：可以约束表中任意一个或多个字段。与列定义相互独立，不包含在列定义中；与定义用‘，’分隔；必须指出要约束的列的名称；</p>
<p>(2)   <strong>列级约束</strong>：包含在列定义中，直接跟在该列的其它定义之后 ，用空格分隔；不必指定列名；</p>
<h5 id="实例二"><a href="#实例二" class="headerlink" title="实例二"></a>实例二</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">-- 删除表：</span><br><span class="line">drop table t_student;</span><br><span class="line">-- 创建数据库表：</span><br><span class="line">create table t_student(</span><br><span class="line">        sno int(6) auto_increment, </span><br><span class="line">        sname varchar(5) not null, </span><br><span class="line">        sex char(1) default &#x27;男&#x27;,</span><br><span class="line">        age int(3),</span><br><span class="line">        enterdate date,</span><br><span class="line">        classname varchar(10),</span><br><span class="line">        email varchar(15),</span><br><span class="line">    -- 表级约束：</span><br><span class="line">        constraint pk_stu primary key (sno),  -- pk_stu 主键约束的名字</span><br><span class="line">        constraint ck_stu_sex check (sex = &#x27;男&#x27; || sex = &#x27;女&#x27;),</span><br><span class="line">        constraint ck_stu_age check (age &gt;= 18 and age &lt;= 50),</span><br><span class="line">        constraint uq_stu_email unique (email)</span><br><span class="line">);</span><br><span class="line">-- 添加数据：</span><br><span class="line">insert into t_student values (1,&#x27;张三&#x27;,&#x27;男&#x27;,21,&#x27;2023-9-1&#x27;,&#x27;java01班&#x27;,&#x27;zs@126.com&#x27;);</span><br><span class="line">-- &gt; 3819 - Check constraint &#x27;ck_stu_sex&#x27; is violated.</span><br><span class="line">-- &gt; 3819 - Check constraint &#x27;ck_stu_age&#x27; is violated.</span><br><span class="line">-- &gt; 1062 - Duplicate entry &#x27;zs@126.com&#x27; for key &#x27;t_student.uq_stu_email&#x27;</span><br><span class="line">insert into t_student values (3,&#x27;李四&#x27;,&#x27;男&#x27;,21,&#x27;2023-9-1&#x27;,&#x27;java01班&#x27;,&#x27;zs@126.com&#x27;);</span><br><span class="line">-- 查看数据：</span><br><span class="line">select * from t_student;</span><br></pre></td></tr></table></figure>

<h4 id="创建表之后添加约束"><a href="#创建表之后添加约束" class="headerlink" title="- 创建表之后添加约束"></a>- 创建表之后添加约束</h4><h5 id="实例三"><a href="#实例三" class="headerlink" title="实例三"></a>实例三</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">-- 删除表：</span><br><span class="line">drop table t_student;</span><br><span class="line">-- 创建数据库表：</span><br><span class="line">create table t_student(</span><br><span class="line">        sno int(6), </span><br><span class="line">        sname varchar(5) not null, </span><br><span class="line">        sex char(1) default &#x27;男&#x27;,</span><br><span class="line">        age int(3),</span><br><span class="line">        enterdate date,</span><br><span class="line">        classname varchar(10),</span><br><span class="line">        email varchar(15)</span><br><span class="line">);</span><br><span class="line">-- &gt; 1075 - Incorrect table definition; there can be only one auto column and it must be defined as a key</span><br><span class="line">-- 错误的解决办法：就是auto_increment去掉</span><br><span class="line">-- 在创建表以后添加约束：</span><br><span class="line">alter table t_student add constraint pk_stu primary key (sno) ; -- 主键约束</span><br><span class="line">alter table t_student modify sno int(6) auto_increment; -- 修改自增条件</span><br><span class="line">alter table t_student add constraint ck_stu_sex check (sex = &#x27;男&#x27; || sex = &#x27;女&#x27;);</span><br><span class="line">alter table t_student add constraint ck_stu_age check (age &gt;= 18 and age &lt;= 50);</span><br><span class="line">alter table t_student add constraint uq_stu_email unique (email);</span><br><span class="line">-- 查看表结构：</span><br><span class="line">desc t_student;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>验证约束添加成功：</p>
<img src="/2021/05/07/MySQL/20210701105406.png" alt="image-20210701105405972" style="zoom:67%;">



<h2 id="2-外键约束"><a href="#2-外键约束" class="headerlink" title="2. 外键约束"></a>2. 外键约束</h2><ul>
<li>外键约束（FOREIGN KEY，缩写FK）是用来实现数据库表的参照完整性的。<strong>外键约束可以使两张表紧密的结合起来，特别是针对修改或者删除的级联操作时，会保证数据的完整性。</strong></li>
<li>外键是指表中某个字段的值依赖于另一张表中某个字段的值，而被依赖的字段必须具有主键约束或者唯一约束。被依赖的表我们通常称之为父表或者主表，设置外键约束的表称为子表或者从表。</li>
<li>只有<strong>表级约束</strong>没有列级约束</li>
</ul>
<h5 id="实例四"><a href="#实例四" class="headerlink" title="实例四"></a>实例四</h5><p>主表（父表）：班级表  -  班级编号 - 主键</p>
<p> 从表（子表）：学生表 - 班级编号 - 外键</p>
<ol>
<li><p>创建父表—班级表：</p>
</li>
<li><ul>
<li><p>cno(主键、自增)；cname（不为空）；room；</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-- 先删除表，先删除从表再删除父表</span><br><span class="line">drop table t_student;</span><br><span class="line">drop table t_class;</span><br><span class="line">-- 先创建父表：班级表：</span><br><span class="line">create table t_class(</span><br><span class="line">        cno int(4) primary key auto_increment,</span><br><span class="line">        cname varchar(10) not null,</span><br><span class="line">        room char(4)</span><br><span class="line">)</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>创建从表—学生表：</p>
<ul>
<li><p>sno(主键、自增)；sname（不为空）；classno（取值参考t_class表中的cno字段，不要求字段名字完全重复，但是类型长度定义 尽量要求相同。);</p>
</li>
<li><p><strong>添加外键约束</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-- 添加学生表，添加外键约束：</span><br><span class="line">create table t_student(</span><br><span class="line">        sno int(6) primary key auto_increment, </span><br><span class="line">        sname varchar(5) not null, </span><br><span class="line">        classno int(4),-- 取值参考t_class表中的cno字段，不要求字段名字完全重复，但是类型长度定义 尽量要求相同。</span><br><span class="line">    -- 外键约束：</span><br><span class="line">        constraint fk_stu_classno foreign key (classno) references t_class (cno)</span><br><span class="line">    </span><br><span class="line">);</span><br></pre></td></tr></table></figure></li>
</ul>
<ul>
<li><p><strong>删除外键约束</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-- 删除外键约束</span><br><span class="line">alter table EMP</span><br><span class="line">	drop foreign key FK_DEPTNO</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>添加数据：</p>
</li>
<li><p>可以一次性添加多条记录：</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-- 可以一次性添加多条记录：</span><br><span class="line">insert into t_class values (null,&#x27;java001&#x27;,&#x27;r803&#x27;),(null,&#x27;java002&#x27;,&#x27;r416&#x27;),(null,&#x27;大数据001&#x27;,&#x27;r103&#x27;);</span><br><span class="line">insert into t_student values (null,&#x27;张三&#x27;,1),(null,&#x27;李四&#x27;,1),(null,&#x27;王五&#x27;,2),(null,&#x27;朱六&#x27;,3);</span><br></pre></td></tr></table></figure></li>
<li><p>查询班级表：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-- 查看班级表和学生表：</span><br><span class="line">select * from t_class;</span><br><span class="line">select * from t_student;</span><br></pre></td></tr></table></figure></li>
<li><p><strong>添加外键的效果</strong>：</p>
<ul>
<li>删除班级会出错</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 尝试删除班级</span><br><span class="line">delete from t_class where cno = 1;</span><br></pre></td></tr></table></figure>

<img src="/2021/05/07/MySQL/20210701111051.png" alt="image-20210701111051536" style="zoom:67%;"></li>
</ol>
<h4 id="外键策略："><a href="#外键策略：" class="headerlink" title="外键策略："></a><strong>外键策略：</strong></h4><p>直接删除班级会错误，有时候必须删，可以加入外键策略</p>
<h6 id="策略一：no-action-不允许操作"><a href="#策略一：no-action-不允许操作" class="headerlink" title="策略一：no action 不允许操作"></a>策略一：no action 不允许操作</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-- 策略1：no action 不允许操作</span><br><span class="line">-- 通过操作sql来完成：</span><br><span class="line">-- 先把班级2的学生对应的班级 改为null </span><br><span class="line">update t_student set classno = null where classno = 2;</span><br><span class="line">-- 然后再删除班级2   </span><br><span class="line">delete from t_class where cno = 2;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<img src="/2021/05/07/MySQL/20210701112307.png" alt="image-20210701112307207" style="zoom:67%;">

<img src="/2021/05/07/MySQL/20210701112344.png" alt="image-20210701112344539" style="zoom: 50%;">

<h6 id="策略二：使用cascade级联操作"><a href="#策略二：使用cascade级联操作" class="headerlink" title="策略二：使用cascade级联操作"></a>策略二：使用cascade级联操作</h6><p>操作主表的时候影响从表的外键</p>
<ul>
<li><p>先删除外键约束</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 策略2：cascade 级联操作：操作主表的时候影响从表的外键信息：</span><br><span class="line">alter table t_student drop foreign key fk_stu_classno;</span><br></pre></td></tr></table></figure></li>
<li><p>重新添加外键约束（增加一个级联操作）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 重新添加外键约束：</span><br><span class="line">alter table t_student add constraint fk_stu_classno foreign key (classno) references t_class (cno) on update cascade on delete cascade;</span><br></pre></td></tr></table></figure></li>
<li><p>试着更新和删除操作：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-- 试试更新：</span><br><span class="line">update t_class set cno = 5 where cno = 3;</span><br><span class="line">-- 试试删除：</span><br><span class="line">delete from t_class where cno = 5;</span><br></pre></td></tr></table></figure>

<p>结果</p>
<img src="/2021/05/07/MySQL/20210701113031.png" alt="image-20210701113031631" style="zoom:50%;"></li>
</ul>
<h6 id="策略三：set-null-置空操作"><a href="#策略三：set-null-置空操作" class="headerlink" title="策略三：set null     置空操作"></a>策略三：set null     置空操作</h6><ul>
<li><p>先删除之前的外键约束</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 先删除之前的外键约束：</span><br><span class="line">alter table t_student drop foreign key fk_stu_classno;</span><br></pre></td></tr></table></figure></li>
<li><p>重新添加外键约束</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 重新添加外键约束：</span><br><span class="line">alter table t_student add constraint fk_stu_classno foreign key (classno) references t_class (cno) on update set null on delete set null;</span><br></pre></td></tr></table></figure></li>
<li><p>试着更新操作</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 更新</span><br><span class="line">update t_class set cno = 5 whwere con = 1;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<img src="/2021/05/07/MySQL/20210701142452.png" alt="image-20210701142451962" style="zoom:67%;">

<img src="/2021/05/07/MySQL/20210701142510.png" alt="image-20210701142510409" style="zoom: 50%;"></li>
</ul>
<p>注：策略2 级联操作  和  策略2 的  删除操作  可以混着使用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">alter table t_student add constraint fk_stu_classno foreign key (classno) references t_class (cno) on update cascade on delete set null ;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>应用场合：</p>
<p>– （1）朋友圈删除，点赞。留言都删除  –  级联操作<br>– （2）解散班级，对应的学生 置为班级为null就可以了，– set null</p>
<h1 id="DQL查询操作"><a href="#DQL查询操作" class="headerlink" title="DQL查询操作*"></a>DQL查询操作*</h1><h2 id="1-常见表的准备"><a href="#1-常见表的准备" class="headerlink" title="1. 常见表的准备"></a>1. 常见表的准备</h2><h3 id="部门表-dept"><a href="#部门表-dept" class="headerlink" title="部门表(dept)"></a>部门表(dept)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">create table DEPT(  </span><br><span class="line">  DEPTNO int(2) not null,  </span><br><span class="line">  DNAME  VARCHAR(14),  </span><br><span class="line">  LOC    VARCHAR(13)  </span><br><span class="line">);  </span><br><span class="line">alter table DEPT </span><br><span class="line">  add constraint PK_DEPT primary key (DEPTNO); </span><br></pre></td></tr></table></figure>

<h3 id="员工表（emp"><a href="#员工表（emp" class="headerlink" title="员工表（emp)"></a>员工表（emp)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">create table EMP  </span><br><span class="line">(  </span><br><span class="line">  EMPNO    int(4) primary key,  </span><br><span class="line">  ENAME    VARCHAR(10),  </span><br><span class="line">  JOB      VARCHAR(9),  </span><br><span class="line">  MGR      int(4),  </span><br><span class="line">  HIREDATE DATE,  </span><br><span class="line">  SAL      double(7,2),  </span><br><span class="line">  COMM     double(7,2),  </span><br><span class="line">  DEPTNO   int(2)  </span><br><span class="line">);  </span><br><span class="line">alter table EMP  </span><br><span class="line">  add constraint FK_DEPTNO foreign key (DEPTNO)  </span><br><span class="line">  references DEPT (DEPTNO);  </span><br></pre></td></tr></table></figure>

<h3 id="薪资登记表-salgrade"><a href="#薪资登记表-salgrade" class="headerlink" title="薪资登记表(salgrade)"></a>薪资登记表(salgrade)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">create table SALGRADE  </span><br><span class="line">(  </span><br><span class="line">  GRADE int primary key,  </span><br><span class="line">  LOSAL double(7,2),  </span><br><span class="line">  HISAL double(7,2)  </span><br><span class="line">);  </span><br></pre></td></tr></table></figure>

<h3 id="奖金表-bonus"><a href="#奖金表-bonus" class="headerlink" title="奖金表(bonus)"></a>奖金表(bonus)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">create table BONUS  </span><br><span class="line">(  </span><br><span class="line">  ENAME VARCHAR(10),  </span><br><span class="line">  JOB   VARCHAR(9),  </span><br><span class="line">  SAL   double(7,2),  </span><br><span class="line">  COMM  double(7,2)  </span><br><span class="line">);  </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="操作"><a href="#操作" class="headerlink" title="操作"></a>操作</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">-- DEPT</span><br><span class="line">insert into DEPT (DEPTNO, DNAME, LOC)  </span><br><span class="line">values (10, &#x27;ACCOUNTING&#x27;, &#x27;NEW YORK&#x27;);  </span><br><span class="line">insert into DEPT (DEPTNO, DNAME, LOC)  </span><br><span class="line">values (20, &#x27;RESEARCH&#x27;, &#x27;DALLAS&#x27;);  </span><br><span class="line">insert into DEPT (DEPTNO, DNAME, LOC)  </span><br><span class="line">values (30, &#x27;SALES&#x27;, &#x27;CHICAGO&#x27;);  </span><br><span class="line">insert into DEPT (DEPTNO, DNAME, LOC)  </span><br><span class="line">values (40, &#x27;OPERATIONS&#x27;, &#x27;BOSTON&#x27;);  </span><br><span class="line">-- EMP</span><br><span class="line">insert into EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line">values (7369, &#x27;SMITH&#x27;, &#x27;CLERK&#x27;, 7902, &#x27;1980-12-17&#x27;, 800, null, 20);  </span><br><span class="line">insert into EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line">values (7499, &#x27;ALLEN&#x27;, &#x27;SALESMAN&#x27;, 7698, &#x27;1981-02-20&#x27;, 1600, 300, 30);  </span><br><span class="line">insert into EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line">values (7521, &#x27;WARD&#x27;, &#x27;SALESMAN&#x27;, 7698, &#x27;1981-02-22&#x27;, 1250, 500, 30);  </span><br><span class="line">insert into EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line">values (7566, &#x27;JONES&#x27;, &#x27;MANAGER&#x27;, 7839, &#x27;1981-04-02&#x27;, 2975, null, 20);  </span><br><span class="line">insert into EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line">values (7654, &#x27;MARTIN&#x27;, &#x27;SALESMAN&#x27;, 7698, &#x27;1981-09-28&#x27;, 1250, 1400, 30);  </span><br><span class="line">insert into EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line">values (7698, &#x27;BLAKE&#x27;, &#x27;MANAGER&#x27;, 7839, &#x27;1981-05-01&#x27;, 2850, null, 30);  </span><br><span class="line">insert into EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line">values (7782, &#x27;CLARK&#x27;, &#x27;MANAGER&#x27;, 7839, &#x27;1981-06-09&#x27;, 2450, null, 10);  </span><br><span class="line">insert into EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line">values (7788, &#x27;SCOTT&#x27;, &#x27;ANALYST&#x27;, 7566, &#x27;1987-04-19&#x27;, 3000, null, 20);  </span><br><span class="line">insert into EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line">values (7839, &#x27;KING&#x27;, &#x27;PRESIDENT&#x27;, null, &#x27;1981-11-17&#x27;, 5000, null, 10);  </span><br><span class="line">insert into EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line">values (7844, &#x27;TURNER&#x27;, &#x27;SALESMAN&#x27;, 7698, &#x27;1981-09-08&#x27;, 1500, 0, 30);  </span><br><span class="line">insert into EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line">values (7876, &#x27;ADAMS&#x27;, &#x27;CLERK&#x27;, 7788, &#x27;1987-05-23&#x27;, 1100, null, 20);  </span><br><span class="line">insert into EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line">values (7900, &#x27;JAMES&#x27;, &#x27;CLERK&#x27;, 7698, &#x27;1981-12-03&#x27;, 950, null, 30);  </span><br><span class="line">insert into EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line">values (7902, &#x27;FORD&#x27;, &#x27;ANALYST&#x27;, 7566, &#x27;1981-12-03&#x27;, 3000, null, 20);  </span><br><span class="line">insert into EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line">values (7934, &#x27;MILLER&#x27;, &#x27;CLERK&#x27;, 7782, &#x27;1982-01-23&#x27;, 1300, null, 10);  </span><br><span class="line">-- SALGRADE</span><br><span class="line">insert into SALGRADE (GRADE, LOSAL, HISAL)  </span><br><span class="line">values (1, 700, 1200);  </span><br><span class="line">insert into SALGRADE (GRADE, LOSAL, HISAL)  </span><br><span class="line">values (2, 1201, 1400);  </span><br><span class="line">insert into SALGRADE (GRADE, LOSAL, HISAL)  </span><br><span class="line">values (3, 1401, 2000);  </span><br><span class="line">insert into SALGRADE (GRADE, LOSAL, HISAL)  </span><br><span class="line">values (4, 2001, 3000);  </span><br><span class="line">insert into SALGRADE (GRADE, LOSAL, HISAL)  </span><br><span class="line">values (5, 3001, 9999);  </span><br><span class="line"></span><br><span class="line">-- 查看表：</span><br><span class="line">select * from dept; </span><br><span class="line">-- 部门表：dept:department 部分 ，loc - location 位置</span><br><span class="line">select * from emp;</span><br><span class="line">-- 员工表：emp:employee 员工   ,mgr :manager上级领导编号，hiredate 入职日期  firedate 解雇日期 ，common：补助</span><br><span class="line">-- deptno 外键 参考  dept - deptno字段</span><br><span class="line">-- mgr 外键  参考  自身表emp - empno  产生了自关联</span><br><span class="line">select * from salgrade;</span><br><span class="line">-- losal - lowsal</span><br><span class="line">-- hisal - highsal</span><br><span class="line">select * from bonus;</span><br></pre></td></tr></table></figure>

<h3 id="结果-表格形式"><a href="#结果-表格形式" class="headerlink" title="结果(表格形式)"></a>结果(表格形式)</h3><img src="/2021/05/07/MySQL/20210701143713.png" alt="image-20210701143713377" style="zoom:67%;">

<img src="/2021/05/07/MySQL/20210701143726.png" alt="image-20210701143726512" style="zoom:67%;">

<img src="/2021/05/07/MySQL/20210701143737.png" alt="image-20210701143737874" style="zoom:67%;">

<img src="/2021/05/07/MySQL/20210701143749.png" alt="image-20210701143749663" style="zoom:67%;">

<h2 id="2-单表查询"><a href="#2-单表查询" class="headerlink" title="2.  单表查询"></a>2.  单表查询</h2><h3 id="2-1-简单的SQL查询"><a href="#2-1-简单的SQL查询" class="headerlink" title="2.1 简单的SQL查询"></a>2.1 简单的SQL查询</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">-- 对emp表查询：</span><br><span class="line">select * from emp; -- *代表所有数据</span><br><span class="line">-- 显示部分列：</span><br><span class="line">select empno,ename,sal from emp;</span><br><span class="line">-- 显示部分行：where子句</span><br><span class="line">select * from emp where sal &gt; 2000;</span><br><span class="line">-- 显示部分列，部分行：</span><br><span class="line">select empno,ename,job,mgr from emp where sal &gt; 2000;</span><br><span class="line">-- 起别名：</span><br><span class="line">select empno 员工编号,ename 姓名,sal 工资 from emp; -- as 省略，&#x27;&#x27;或者&quot;&quot;省略了</span><br><span class="line">-- as alias 别名</span><br><span class="line">select empno as 员工编号,ename as 姓名,sal as 工资 from emp;</span><br><span class="line">select empno as &#x27;员工编号&#x27;,ename as &quot;姓名&quot;,sal as 工资 from emp;</span><br><span class="line">-- &gt; 1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;编号,ename as &quot;姓 名&quot;,sal as 工资 from emp&#x27; at line 1</span><br><span class="line">-- 错误原因：在别名中有特殊符号的时候，&#x27;&#x27;或者&quot;&quot;不可以省略不写</span><br><span class="line">select empno as 员工 编号,ename as &quot;姓 名&quot;,sal as 工资 from emp;</span><br><span class="line">-- 算术运算符：</span><br><span class="line">select empno,ename,sal,sal+1000 as &#x27;涨薪后&#x27;,deptno from emp where sal &lt; 2500;</span><br><span class="line">select empno,ename,sal,comm,sal+comm from emp;  -- ？？？后面再说</span><br><span class="line">-- 去重操作：</span><br><span class="line">select job from emp;</span><br><span class="line">select distinct job from emp;</span><br><span class="line">select job,deptno from emp;</span><br><span class="line">select distinct job,deptno from emp; -- 对后面的所有列组合 去重 ，而不是单独的某一列去重</span><br><span class="line">-- 排序：</span><br><span class="line">select * from emp order by sal; -- 默认情况下是按照升序排列的</span><br><span class="line">select * from emp order by sal asc; -- asc 升序，可以默认不写</span><br><span class="line">select * from emp order by sal desc; -- desc 降序</span><br><span class="line">select * from emp order by sal asc ,deptno desc; -- 在工资升序的情况下，deptno按照降序排列</span><br></pre></td></tr></table></figure>



<h3 id="2-2-where子句"><a href="#2-2-where子句" class="headerlink" title="2.2 where子句"></a>2.2 where子句</h3><p>将过滤条件放在where子句的后面，可以筛选/过滤出我们想要的符合条件的数据</p>
<ul>
<li><p>加关系运算符</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">-- where 子句 + 关系运算符</span><br><span class="line">select * from emp where deptno = 10;</span><br><span class="line">select * from emp where deptno &gt; 10;</span><br><span class="line">select * from emp where deptno &gt;= 10;</span><br><span class="line">select * from emp where deptno &lt; 10;</span><br><span class="line">select * from emp where deptno &lt;= 10;</span><br><span class="line">select * from emp where deptno &lt;&gt; 10;</span><br><span class="line">select * from emp where deptno != 10;</span><br><span class="line">select * from emp where job = &#x27;CLERK&#x27;; </span><br><span class="line">select * from emp where job = &#x27;clerk&#x27;; -- 默认情况下不区分大小写 </span><br><span class="line">select * from emp where binary job = &#x27;clerk&#x27;; -- binary区分大小写</span><br><span class="line">select * from emp where hiredate &lt; &#x27;1981-12-25&#x27;;</span><br></pre></td></tr></table></figure></li>
<li><p>加逻辑运算符</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">-- where 子句 + 逻辑运算符：and </span><br><span class="line">select * from emp where sal &gt; 1500 and sal &lt; 3000;  -- (1500,3000)</span><br><span class="line">select * from emp where sal &gt; 1500 &amp;&amp; sal &lt; 3000; </span><br><span class="line">select * from emp where sal &gt; 1500 and sal &lt; 3000 order by sal;</span><br><span class="line">select * from emp where sal between 1500 and 3000; -- [1500,3000]</span><br><span class="line">-- where 子句 + 逻辑运算符：or</span><br><span class="line">select * from emp where deptno = 10 or deptno = 20;</span><br><span class="line">select * from emp where deptno = 10 || deptno = 20;</span><br><span class="line">select * from emp where deptno in (10,20);</span><br><span class="line">select * from emp where job in (&#x27;MANAGER&#x27;,&#x27;CLERK&#x27;,&#x27;ANALYST&#x27;);</span><br></pre></td></tr></table></figure></li>
<li><p>加模糊查询</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-- where子句 + 模糊查询：</span><br><span class="line">-- 查询名字中带A的员工  -- %代表任意多个字符 0,1,2，.....</span><br><span class="line">select * from emp where ename like &#x27;%A%&#x27; ;</span><br><span class="line">-- -任意一个字符</span><br><span class="line">select * from emp where ename like &#x27;__A%&#x27; ;</span><br></pre></td></tr></table></figure></li>
<li><p>关于null的判断</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-- 关于null的判断：</span><br><span class="line">select * from emp where comm is null;</span><br><span class="line">select * from emp where comm is not null;</span><br></pre></td></tr></table></figure></li>
<li><p>小括号的使用：因为不同运算符的优先级别不同，加括号为了可读性</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-- 小括号的使用  ：因为不同的运算符的优先级别不同，加括号为了可读性</span><br><span class="line">select * from emp where job = &#x27;SALESMAN&#x27; or job = &#x27;CLERK&#x27; and sal &gt;=1500; -- 先and再or  and &gt; or</span><br><span class="line">select * from emp where job = &#x27;SALESMAN&#x27; or (job = &#x27;CLERK&#x27; and sal &gt;=1500); </span><br><span class="line">select * from emp where (job = &#x27;SALESMAN&#x27; or job = &#x27;CLERK&#x27;) and sal &gt;=1500;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="2-3-函数"><a href="#2-3-函数" class="headerlink" title="2.3 函数"></a>2.3 函数</h3><p><em><strong>除了多行函数（max,min,count,sum,avg），都是单行函数</strong></em></p>
<h4 id="单行函数"><a href="#单行函数" class="headerlink" title="- 单行函数"></a>- 单行函数</h4><h5 id="1-字符串函数"><a href="#1-字符串函数" class="headerlink" title="1. 字符串函数"></a>1. 字符串函数</h5><table>
<thead>
<tr>
<th><strong>函数</strong></th>
<th><strong>描述</strong></th>
</tr>
</thead>
<tbody><tr>
<td>CONCAT(str1, str2, ···, strn)</td>
<td>将str1、str2···strn拼接成一个新的字符串</td>
</tr>
<tr>
<td>INSERT(str, index, n,  newstr)</td>
<td>将字符串str从第index位置开始的n个字符替换成字符串newstr</td>
</tr>
<tr>
<td>LENGTH(str)</td>
<td>获取字符串str的长度</td>
</tr>
<tr>
<td>LOWER(str)</td>
<td>将字符串str中的每个字符转换为小写</td>
</tr>
<tr>
<td>UPPER(str)</td>
<td>将字符串str中的每个字符转换为大写</td>
</tr>
<tr>
<td>LEFT(str, n)</td>
<td>获取字符串str最左边的n个字符</td>
</tr>
<tr>
<td>RIGHT(str, n)</td>
<td>获取字符串str最右边的n个字符</td>
</tr>
<tr>
<td>LPAD(str, n, pad)</td>
<td>使用字符串pad在str的最左边进行填充，直到长度为n个字符为止</td>
</tr>
<tr>
<td>RPAD(str, n, pad)</td>
<td>使用字符串pad在str的最右边进行填充，直到长度为n个字符为止</td>
</tr>
<tr>
<td>LTRIM(str)</td>
<td>去除字符串str左侧的空格</td>
</tr>
<tr>
<td>RTRIM(str)</td>
<td>去除字符串str右侧的空格</td>
</tr>
<tr>
<td>TRIM(str)</td>
<td>去除字符串str左右两侧的空格</td>
</tr>
<tr>
<td>REPLACE(str,oldstr,newstr)</td>
<td>用字符串newstr替换字符串str中所有的子字符串oldstr</td>
</tr>
<tr>
<td>REVERSE(str)</td>
<td>将字符串str中的字符逆序</td>
</tr>
<tr>
<td>STRCMP(str1,  str2)</td>
<td>比较字符串str1和str2的大小</td>
</tr>
<tr>
<td>SUBSTRING(str,index,n)</td>
<td>获取从字符串str的index位置开始的n个字符</td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-- 1.字符串函数</span><br><span class="line">select ename,length(ename),substring(ename,2,3) from emp;</span><br><span class="line">-- substring字符串截取，2:从字符下标为2开始，3：截取长度3    （下标从1开始）</span><br></pre></td></tr></table></figure>

<p>显示结果：</p>
<img src="/2021/05/07/MySQL/20210630210116.png" alt="image-20210630210115889" style="zoom:50%;">



<h5 id="2-数值函数"><a href="#2-数值函数" class="headerlink" title="2. 数值函数"></a>2. 数值函数</h5><table>
<thead>
<tr>
<th align="left"><strong>函数</strong></th>
<th><strong>描述</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="left">ABS(num)</td>
<td>返回num的绝对值</td>
</tr>
<tr>
<td align="left">CEIL(num)</td>
<td>返回大于num的最小整数（向上取整）</td>
</tr>
<tr>
<td align="left">FLOOR(num)</td>
<td>返回小于num的最大整数（向下取整）</td>
</tr>
<tr>
<td align="left">MOD(num1, num2)</td>
<td>返回num1/num2的余数（取模）</td>
</tr>
<tr>
<td align="left">PI()</td>
<td>返回圆周率的值</td>
</tr>
<tr>
<td align="left">POW(num,n)/POWER(num,  n)</td>
<td>返回num的n次方</td>
</tr>
<tr>
<td align="left">RAND(num)</td>
<td>返回0~1之间的随机数</td>
</tr>
<tr>
<td align="left">ROUND(num, n)</td>
<td>返回x四舍五入后的值，该值保留到小数点后n位</td>
</tr>
<tr>
<td align="left">TRUNCATE(num, n)</td>
<td>返回num被舍去至小数点后n位的值</td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-- 2.数值函数</span><br><span class="line">select abs(-5),ceil(5.3),floor(5.9),round(3.14) from dual; -- dual实际就是一个伪表</span><br><span class="line">select abs(-5) 绝对值,ceil(5.3) 向上取整,floor(5.9) 向下取整,round(3.14) 四舍五入;  </span><br><span class="line">-- 如果没有where条件的话，from dual可以省略不写</span><br><span class="line">select ceil(sal) from emp;</span><br><span class="line">select 10/3,10%3,mod(10,3) ;</span><br></pre></td></tr></table></figure>

<p>显示结果：</p>
<img src="/2021/05/07/MySQL/20210630210456.png" alt="image-20210630210456370" style="zoom:50%;">



<h5 id="3-日期与时间函数"><a href="#3-日期与时间函数" class="headerlink" title="3. 日期与时间函数"></a>3. 日期与时间函数</h5><table>
<thead>
<tr>
<th><strong>函数</strong></th>
<th><strong>描述</strong></th>
</tr>
</thead>
<tbody><tr>
<td>CURDATE()</td>
<td>返回当前日期</td>
</tr>
<tr>
<td>CURTIME()</td>
<td>返回当前时间</td>
</tr>
<tr>
<td>NOW()</td>
<td>返回当前日期和时间</td>
</tr>
<tr>
<td>SYSDATE()</td>
<td>返回该函数执行时的日期和时间</td>
</tr>
<tr>
<td>DAYOFYEAR(date)</td>
<td>返回日期date为一年中的第几天</td>
</tr>
<tr>
<td>WEEK(date)/WEEKOFYEAR(date)</td>
<td>返回日期date为一年中的第几周</td>
</tr>
<tr>
<td>DATE_FORMAT(date,  format)</td>
<td>返回按字符串format格式化后的日期date</td>
</tr>
<tr>
<td>DATE_ADD(date,  INTERVAL expr unit)    /ADDDATE(date,  INTERVAL expr unit)</td>
<td>返回date加上一个时间间隔后的新时间值</td>
</tr>
<tr>
<td>DATE_SUB(date,  INTERVAL expr unit)    /SUBDATE(date,  INTERVAL expr unit)</td>
<td>返回date减去一个时间间隔后的新时间值</td>
</tr>
<tr>
<td>DATEDIFF(date1,  date2)</td>
<td>返回起始日期date1与结束日期date2之间的间隔天数</td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-- 3.日期与时间函数 </span><br><span class="line">select * from emp;</span><br><span class="line">select curdate(),curtime() ; -- curdate()年月日 curtime()时分秒</span><br><span class="line">select now(),sysdate(),sleep(3),now(),sysdate() from dual; -- now(),sysdate() 年月日时分秒</span><br><span class="line">insert into emp values (9999,&#x27;lili&#x27;,&#x27;SALASMAN&#x27;,7698,now(),1000,null,30);</span><br><span class="line">-- now()可以表示年月日时分秒，但是插入数据的时候还是要参照表的结构的</span><br><span class="line">desc emp;</span><br></pre></td></tr></table></figure>



<img src="/2021/05/07/MySQL/20210630223758.png" alt="image-20210630223758495" style="zoom:50%;">

<img src="/2021/05/07/MySQL/20210630223819.png" alt="image-20210630223819827" style="zoom:50%;">

<img src="/2021/05/07/MySQL/20210630223829.png" alt="image-20210630223829883" style="zoom:50%;">

<h5 id="4-流程函数"><a href="#4-流程函数" class="headerlink" title="4. 流程函数"></a>4. 流程函数</h5><img src="/2021/05/07/MySQL/20210630224323.png" alt="image-20210630224323874" style="zoom:67%;">

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">-- 4.流程函数</span><br><span class="line">-- if相关</span><br><span class="line">select empno,ename,sal,if(sal&gt;=2500,&#x27;高薪&#x27;,&#x27;底薪&#x27;) as &#x27;薪资等级&#x27; from emp; -- if-else 双分支结构</span><br><span class="line">select empno,ename,sal,comm,sal+ifnull(comm,0) from emp; -- 如果comm是null，那么取值为0 -- 单分支</span><br><span class="line">select nullif(1,1),nullif(1,2) from dual; --  如果value1等于value2，则返回null，否则返回value1  </span><br><span class="line">-- case相关：</span><br><span class="line">-- case等值判断</span><br><span class="line">select empno,ename,job,</span><br><span class="line">case job </span><br><span class="line"> when &#x27;CLERK&#x27; then &#x27;店员&#x27;</span><br><span class="line"> when &#x27;SALESMAN&#x27;  then &#x27;销售&#x27;</span><br><span class="line"> when &#x27;MANAGER&#x27; then &#x27;经理&#x27;</span><br><span class="line"> else &#x27;其他&#x27;</span><br><span class="line">end &#x27;岗位&#x27;,</span><br><span class="line">sal from emp;</span><br><span class="line">-- case区间判断:</span><br><span class="line">select empno,ename,sal,</span><br><span class="line">case </span><br><span class="line"> when sal&lt;=1000 then &#x27;A&#x27;</span><br><span class="line"> when sal&lt;=2000 then &#x27;B&#x27;</span><br><span class="line"> when sal&lt;=3000 then &#x27;C&#x27;</span><br><span class="line"> else &#x27;D&#x27;</span><br><span class="line">end &#x27;工资等级&#x27;,</span><br><span class="line">deptno from emp;</span><br><span class="line">from emp;</span><br></pre></td></tr></table></figure>



<h5 id="5-JSON函数"><a href="#5-JSON函数" class="headerlink" title="5. JSON函数"></a>5. JSON函数</h5><img src="/2021/05/07/MySQL/20210630224430.png" alt="image-20210630224430595" style="zoom:67%;">



<h5 id="6-其他函数"><a href="#6-其他函数" class="headerlink" title="6. 其他函数"></a>6. 其他函数</h5><img src="/2021/05/07/MySQL/20210630224453.png" alt="image-20210630224453894" style="zoom:67%;">

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> -- 6.其他函数</span><br><span class="line">select database(),user(),version() from dual;</span><br></pre></td></tr></table></figure>



<h4 id="多行函数"><a href="#多行函数" class="headerlink" title="- 多行函数"></a>- 多行函数</h4><p>对一组数据进行运算，针对一组数据（多行记录）只返回一个结果，也称<strong>分组函数</strong></p>
<img src="/2021/05/07/MySQL/20210630224611.png" alt="image-20210630224611608" style="zoom: 67%;">

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">-- 多行函数：</span><br><span class="line">select max(sal),min(sal),count(sal),sum(sal),sum(sal)/count(sal),avg(sal) from emp;</span><br><span class="line">select * from emp;</span><br><span class="line">-- 多行函数自动忽略null值</span><br><span class="line">select max(comm),min(comm),count(comm),sum(comm),sum(comm)/count(comm),avg(comm) from emp;</span><br><span class="line">-- max(),min(),count()针对所有类型   sum(),avg() 只针对数值型类型有效</span><br><span class="line">select max(ename),min(ename),count(ename),sum(ename),avg(ename) from emp;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- count --计数   </span><br><span class="line">-- 统计表的记录数：方式1：</span><br><span class="line">select * from emp;</span><br><span class="line">select count(ename) from emp;</span><br><span class="line">select count(*) from emp;</span><br><span class="line">-- 统计表的记录数：方式2</span><br><span class="line">select 1 from dual;</span><br><span class="line">select 1 from emp;</span><br><span class="line">select count(1) from emp;</span><br></pre></td></tr></table></figure>



<h3 id="2-4-分组与筛选"><a href="#2-4-分组与筛选" class="headerlink" title="2.4 分组与筛选"></a>2.4 分组与筛选</h3><h4 id="group-by-分组"><a href="#group-by-分组" class="headerlink" title="group by 分组"></a>group by 分组</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">select * from emp;</span><br><span class="line">-- 统计各个部门的平均工资 </span><br><span class="line">select deptno,avg(sal) from emp; -- 字段和多行函数不可以同时使用</span><br><span class="line">select deptno,avg(sal) from emp group by deptno; -- 字段和多行函数不可以同时使用,除非这个字段属于分组</span><br><span class="line">select deptno,avg(sal) from emp group by deptno order by deptno desc;</span><br><span class="line">-- 统计各个岗位的平均工资 统计各个岗位的</span><br><span class="line">select job,avg(sal) from emp group by job;</span><br><span class="line">select job,lower(job),avg(sal) from emp group by job;</span><br></pre></td></tr></table></figure>

<h4 id="having-分组后筛选"><a href="#having-分组后筛选" class="headerlink" title="having 分组后筛选"></a>having 分组后筛选</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-- 统计各个部门的平均工资 ,只显示平均工资2000以上的  - 分组以后进行二次筛选 having</span><br><span class="line">select deptno,avg(sal) from emp group by deptno having avg(sal) &gt; 2000;</span><br><span class="line">select deptno,avg(sal) 平均工资 from emp group by deptno having 平均工资 &gt; 2000;</span><br><span class="line">select deptno,avg(sal) 平均工资 from emp group by deptno having 平均工资 &gt; 2000 order by deptno desc;</span><br></pre></td></tr></table></figure>

<p>where在分组前进行过滤的，having在分组后进行后滤。</p>
<p>对比实例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-- 对比实例：统计各个岗位的平均工资,除了MANAGER</span><br><span class="line">-- 方法1：</span><br><span class="line">select job,avg(sal) from emp where job != &#x27;MANAGER&#x27; group by job;</span><br><span class="line">-- 方法2：</span><br><span class="line">select job,avg(sal) from emp group by job having job != &#x27;MANAGER&#x27; ;</span><br><span class="line">-- where在分组前进行过滤的，having在分组后进行后滤。</span><br></pre></td></tr></table></figure>

<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><h4 id="1-select语句总结"><a href="#1-select语句总结" class="headerlink" title="[1] select语句总结"></a>[1] select语句总结</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">select column, group_function(column) </span><br><span class="line">from table </span><br><span class="line">[where condition] </span><br><span class="line">[group by  group_by_expression] </span><br><span class="line">[having group_condition] </span><br><span class="line">[order by column]; </span><br></pre></td></tr></table></figure>

<p>注意：顺序固定，不可以改变顺序</p>
<h4 id="2-select语句的执行顺序"><a href="#2-select语句的执行顺序" class="headerlink" title="[2] select语句的执行顺序"></a>[2] select语句的执行顺序</h4><p>from — where — group  by —  select — having — order  by</p>
<h4 id="3-单表查询练习"><a href="#3-单表查询练习" class="headerlink" title="[3] 单表查询练习"></a>[3] 单表查询练习</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">-- 单表查询练习：</span><br><span class="line">-- 列出工资最小值小于2000的职位</span><br><span class="line">select job,min(sal)</span><br><span class="line">from emp</span><br><span class="line">group by job</span><br><span class="line">having min(sal) &lt; 2000;</span><br><span class="line">-- 列出平均工资大于1200元的部门和工作搭配组合</span><br><span class="line">select deptno,job,avg(sal)</span><br><span class="line">from emp</span><br><span class="line">group by deptno,job</span><br><span class="line">having avg(sal) &gt; 1200</span><br><span class="line">order by avg(sal);</span><br><span class="line">-- 统计[人数小于4的]部门的平均工资。 </span><br><span class="line">select deptno,count(ename),avg(sal) -- 这里可用 count(1)</span><br><span class="line">from emp</span><br><span class="line">group by deptno</span><br><span class="line">having count(ename) &lt; 4;</span><br><span class="line"></span><br><span class="line">-- 统计各部门的最高工资，排除最高工资小于3000的部门。</span><br><span class="line">select deptno,max(sal)</span><br><span class="line">from emp</span><br><span class="line">group by deptno</span><br><span class="line">having max(sal) &gt;= 3000;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="3-多表查询"><a href="#3-多表查询" class="headerlink" title="3.  多表查询"></a>3.  多表查询</h2><h3 id="3-1-交叉连接-cross-join"><a href="#3-1-交叉连接-cross-join" class="headerlink" title="3.1  交叉连接 cross join"></a>3.1  交叉连接 cross join</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select *</span><br><span class="line">from emp</span><br><span class="line">cross join dept;</span><br></pre></td></tr></table></figure>



<h3 id="3-2-自然连接-natural"><a href="#3-2-自然连接-natural" class="headerlink" title="3.2  自然连接 natural"></a>3.2  自然连接 natural</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select * </span><br><span class="line">from emp</span><br><span class="line">natural join dept;</span><br></pre></td></tr></table></figure>

<p>优点：自动匹配所有的同名列 ，同名列只显示一次，简单</p>
<p>缺点：查询字段的时候，没有指定字段对应的数据库表，效率低</p>
<p><strong>解决——指定表名</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select emp.empno,emp.enaem,emp.sal,dept.dname,dept.loc,dept.deptno</span><br><span class="line">from emp</span><br><span class="line">natural join dept;</span><br></pre></td></tr></table></figure>

<p>缺点：表名太长 </p>
<p><strong>解决——起表名</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select e.empno,e.ename,e.sal,d.dname,d.loc,d.deptno</span><br><span class="line">from emp e</span><br><span class="line">natural join dept d;</span><br></pre></td></tr></table></figure>

<p>缺点：会自动匹配所有表中同名的字段。有时候我们只需要部分相同的字段</p>
<h3 id="3-3-内连接-inner-join"><a href="#3-3-内连接-inner-join" class="headerlink" title="3.3 内连接 inner join"></a>3.3 内连接 inner join</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select * </span><br><span class="line">from emp e</span><br><span class="line">inner join dept d </span><br><span class="line">using(deptno); -- 同名字段才有效</span><br></pre></td></tr></table></figure>

<p>缺点：连接的表字段不同时using无法使用。</p>
<p>解决——<strong>使用on子句</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select *</span><br><span class="line">from emp e</span><br><span class="line">inner join dept d -- 使用on的时候inner可以省略</span><br><span class="line">on e.deptno = d.deptno;</span><br></pre></td></tr></table></figure>





<h3 id="3-4-外连接-outer-join"><a href="#3-4-外连接-outer-join" class="headerlink" title="3.4 外连接  outer  join"></a>3.4 外连接  outer  join</h3><ul>
<li>内连接只显示匹配的数据，例如一个部门没有员工就不会显示</li>
<li><strong>外连接可以显示不匹配的数据</strong></li>
<li>outer都可以省略的</li>
</ul>
<h5 id="左外连接"><a href="#左外连接" class="headerlink" title="左外连接"></a>左外连接</h5><p>左边的那个表的信息，即使不匹配也可以查看出结果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select * </span><br><span class="line">from emp</span><br><span class="line">left outer join dept d</span><br><span class="line">on e.deptno = d.deptno</span><br></pre></td></tr></table></figure>

<p>结果</p>
<img src="/2021/05/07/MySQL/20210701170246.png" alt="image-20210701170246009" style="zoom:67%;">

<h5 id="右外连接"><a href="#右外连接" class="headerlink" title="右外连接"></a>右外连接</h5><p>右边的那个表的信息，即使不匹配也可以查看出结果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select *</span><br><span class="line">from emp e</span><br><span class="line">right outer join dept d</span><br><span class="line">on e.deptno = d.deptno;</span><br></pre></td></tr></table></figure>

<p>结果</p>
<img src="/2021/05/07/MySQL/20210701163643.png" alt="image-20210701163643122" style="zoom:67%;">

<h5 id="全外连接"><a href="#全外连接" class="headerlink" title="全外连接"></a>全外连接</h5><p>这个语法在mysql里面不支持，oracle才支持</p>
<p>为了代替 可以取左外连接和右外连接的并集</p>
<h6 id="并集-union"><a href="#并集-union" class="headerlink" title="并集 union"></a>并集 union</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">select * </span><br><span class="line">from emp</span><br><span class="line">left outer join dept d</span><br><span class="line">on e.deptno = d.deptno</span><br><span class="line">union -- 并集，不去重，效率低</span><br><span class="line">select *</span><br><span class="line">from emp e</span><br><span class="line">right outer join dept d</span><br><span class="line">on e.deptno = d.deptno;</span><br></pre></td></tr></table></figure>

<p>结果</p>
<img src="/2021/05/07/MySQL/20210701170831.png" alt="image-20210701170831388" style="zoom:67%;">

<h6 id="union-all"><a href="#union-all" class="headerlink" title="union all"></a>union all</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">select * </span><br><span class="line">from emp</span><br><span class="line">left outer join dept d</span><br><span class="line">on e.deptno = d.deptno</span><br><span class="line">union  all -- 不去重的并集， 效率高</span><br><span class="line">select *</span><br><span class="line">from emp e</span><br><span class="line">right outer join dept d</span><br><span class="line">on e.deptno = d.deptno;</span><br></pre></td></tr></table></figure>

<p>结果</p>
<img src="/2021/05/07/MySQL/20210701171121.png" alt="image-20210701171121236" style="zoom:67%;">



<h3 id="3-5-三表查询"><a href="#3-5-三表查询" class="headerlink" title="3.5 三表查询"></a>3.5 三表查询</h3><p>案例：查询员工的编号、姓名、薪水、部门编号、部门名称、薪水等级</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">select * from emp;</span><br><span class="line">select * from dept;</span><br><span class="line">select * from salgrade；</span><br><span class="line"></span><br><span class="line">select *</span><br><span class="line">from emp e</span><br><span class="line">right outer join dept d</span><br><span class="line">on e.deptno = d.deptno;</span><br><span class="line">-- 可以看做就是上面的结果是一张表，然后再和第三张表进行连接</span><br><span class="line">inner join salgrade s</span><br><span class="line">on e.sal between salgrade</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>结果</p>
<img src="/2021/05/07/MySQL/20210701184545.png" alt="image-20210701184545238" style="zoom:67%;">



<h3 id="3-6-自连接查询"><a href="#3-6-自连接查询" class="headerlink" title="3.6 自连接查询"></a>3.6 自连接查询</h3><p>相当于把本身表复制一份，本质与前面的连接没有区别</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">-- 查询员工的编号、姓名、上级编号,上级的姓名</span><br><span class="line">select * from emp;</span><br><span class="line">select e1.empno 员工编号,e1.ename 员工姓名,e1.mgr 领导编号,e2.ename 员工领导姓名</span><br><span class="line">from emp e1</span><br><span class="line">inner join emp e2</span><br><span class="line">on e1.mgr = e2.empno;</span><br><span class="line">-- 左外连接：</span><br><span class="line">select e1.empno 员工编号,e1.ename 员工姓名,e1.mgr 领导编号,e2.ename 员工领导姓名</span><br><span class="line">from emp e1</span><br><span class="line">left outer join emp e2</span><br><span class="line">on e1.mgr = e2.empno;</span><br></pre></td></tr></table></figure>

<p>结果</p>
<img src="/2021/05/07/MySQL/20210702094750.png" alt="image-20210702094750390" style="zoom:67%;">

<h3 id="补充：92语法的多表查询"><a href="#补充：92语法的多表查询" class="headerlink" title="补充：92语法的多表查询"></a>补充：92语法的多表查询</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">-- 查询员工的编号，员工姓名，薪水，员工部门编号，部门名称：</span><br><span class="line">select e.empno,e.ename,e.sal,e.deptno,d.dname</span><br><span class="line">from emp e,dept d</span><br><span class="line">-- 相当于99语法中的cross join ,出现笛卡尔积，没有意义</span><br><span class="line">select e.empno,e.ename,e.sal,e.deptno,d.dname</span><br><span class="line">from emp e,dept d</span><br><span class="line">where e.deptno = d.deptno;</span><br><span class="line">-- 相当于99语法中的natural join </span><br><span class="line">-- 查询员工的编号，员工姓名，薪水，员工部门编号，部门名称，查询出工资大于2000的员工</span><br><span class="line">select e.empno,e.ename,e.sal,e.deptno,d.dname</span><br><span class="line">from emp e,dept d</span><br><span class="line">where e.deptno = d.deptno and e.sal &gt; 2000;</span><br><span class="line">-- 查询员工的名字，岗位，上级编号，上级名称（自连接）：</span><br><span class="line">select e1.ename,e1.job,e1.mgr ,e2.ename </span><br><span class="line">from emp e1,emp e2</span><br><span class="line">where e1.mgr = e2.empno;</span><br><span class="line">-- 查询员工的编号、姓名、薪水、部门编号、部门名称、薪水等级</span><br><span class="line">select e.empno,e.ename,e.sal,e.deptno,d.dname,s.grade </span><br><span class="line">from emp e,dept d,salgrade s</span><br><span class="line">where e.deptno = d.deptno and e.sal &gt;= s.losal and e.sal &lt;= s.hisal;</span><br><span class="line">-- 总结：</span><br><span class="line">-- 1.92语法麻烦 </span><br><span class="line">-- 2.92语法中 表的连接条件 和  筛选条件  是放在一起的没有分开</span><br><span class="line">-- 3.99语法中提供了更多的查询连接类型：cross,natural,inner,outer </span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h2 id="4-不相关子查询"><a href="#4-不相关子查询" class="headerlink" title="4. 不相关子查询"></a>4. 不相关子查询</h2><h3 id="引入-1"><a href="#引入-1" class="headerlink" title="引入"></a>引入</h3><p>要查询所有比“CLARK”工资高的员工的信息</p>
<p>需要两个命令而且第二个命令依托于第一个命令，会相互影响</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-- 命令一：查询clark的工资</span><br><span class="line">select sal from emp where ename = clark; -- 2450</span><br><span class="line">-- 命令二：查询所有比其工资高的员工信息</span><br><span class="line">select * from emp where sal &gt; 2450;</span><br></pre></td></tr></table></figure>

<p>子查询可以通过一个命令解决问题 !</p>
<h3 id="4-1-单行子查询"><a href="#4-1-单行子查询" class="headerlink" title="4.1  单行子查询"></a>4.1  单行子查询</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">-- 将上面两个命令合并</span><br><span class="line">-- 查询工资高于平均工资的雇员的名字和工资</span><br><span class="line">select ename,sal</span><br><span class="line">from emp</span><br><span class="line">where sal &gt; (select sal from emp where sal &gt; avg(sal));</span><br><span class="line"> </span><br><span class="line">-- 查询和CLARK同一部门且比他工资低的雇员的名字和工资</span><br><span class="line">select ename,sal</span><br><span class="line">from emp</span><br><span class="line">where deptno = (select deptno from emp where ename=&#x27;CLARK&#x27;) </span><br><span class="line">	  and </span><br><span class="line">	  sal &lt; (select sal from emp where ename=&#x27;CLARK&#x27; );</span><br><span class="line"></span><br><span class="line">-- 查询职务和SCOTT相同，比SCOTT雇佣时间早的雇员信息</span><br><span class="line">select * </span><br><span class="line">from emp</span><br><span class="line">where job = (select job from emp where ename=&#x27;SCOTT&#x27;)</span><br><span class="line">	  and</span><br><span class="line">	  hiredate &lt; (select hiredate from emp where ename=&#x27;SCOTT&#x27;);</span><br><span class="line">	  </span><br></pre></td></tr></table></figure>

<h3 id="4-2-多行子查询"><a href="#4-2-多行子查询" class="headerlink" title="4.2  多行子查询"></a>4.2  多行子查询</h3><p>子查询查出来的记录为多条：</p>
<h5 id="实例一"><a href="#实例一" class="headerlink" title="实例一"></a>实例一</h5><ul>
<li>查询部门20中职务同部门10的雇员一样的雇员信息。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-- 查询雇员信息</span><br><span class="line">select * from emp;</span><br><span class="line">-- 查询部门20中的雇员信息</span><br><span class="line">select * from emp where deptno = 20;-- CLERK,MANAGER,ANALYST</span><br><span class="line">-- 部门10的雇员的职务：</span><br><span class="line">select job from emp where deptno = 10; -- MANAGER,PRESIDENT,CLERK</span><br></pre></td></tr></table></figure>

<p>如果使用单行子查询，就会报错  -&gt;Subquery returns more than 1 row</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select * from emp </span><br><span class="line">where deptno = 20 </span><br><span class="line">and job in (select job from emp where deptno = 10)</span><br><span class="line">-- &gt; Subquery returns more than 1 row</span><br></pre></td></tr></table></figure>

<p>多行子查询可以解决</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select * from emp </span><br><span class="line">where deptno = 20 </span><br><span class="line">and job = any(select job from emp where deptno = 10) -- any</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="实例二-1"><a href="#实例二-1" class="headerlink" title="实例二"></a>实例二</h5><ul>
<li><p>查询工资比所有的“SALESMAN”都高的雇员的编号、名字和工资</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-- 查询雇员的编号、名字和工资</span><br><span class="line">select empno,ename,sal from emp</span><br><span class="line">-- “SALESMAN”的工资：</span><br><span class="line">select sal from emp where job = &#x27;SALESMAN&#x27;</span><br><span class="line">-- 查询工资比所有的“SALESMAN”都高的雇员的编号、名字和工资。</span><br><span class="line">-- 多行子查询：</span><br><span class="line">select empno,ename,sal </span><br><span class="line">from emp </span><br><span class="line">where sal &gt; all(select sal from emp where job = &#x27;SALESMAN&#x27;);</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-- 单行子查询：</span><br><span class="line">select empno,ename,sal </span><br><span class="line">from emp </span><br><span class="line">where sal &gt; (select max(sal) from emp where job = &#x27;SALESMAN&#x27;);</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="实例三-1"><a href="#实例三-1" class="headerlink" title="实例三"></a>实例三</h5><ul>
<li>查询工资低于任意一个“CLERK”的工资的雇员信息。  </li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">-- 查询雇员信息</span><br><span class="line">select * from emp;</span><br><span class="line">-- 查询工资低于任意一个“CLERK”的工资的雇员信息</span><br><span class="line">select * </span><br><span class="line">from emp</span><br><span class="line">where sal &lt; any(select sal from emp where job = &#x27;CLERK&#x27;)</span><br><span class="line">and job != &#x27;CLERK&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-- 单行子查询：</span><br><span class="line">select * </span><br><span class="line">from emp</span><br><span class="line">where sal &lt; (select max(sal) from emp where job = &#x27;CLERK&#x27;)</span><br><span class="line">and job != &#x27;CLERK&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="5-相关子查询"><a href="#5-相关子查询" class="headerlink" title="5. 相关子查询"></a>5. 相关子查询</h2><h3 id="引入-2"><a href="#引入-2" class="headerlink" title="引入"></a>引入</h3><ul>
<li><p>不相关的子查询引入：<br>不相关的子查询：子查询可以独立运行，先运行子查询，再运行外查询。<br>相关子查询：子查询不可以独立运行，并且先运行外查询，再运行子查询</p>
</li>
<li><p>不相关的子查询优缺点：<br>好处：简单   功能强大（一些使用不相关子查询不能实现或者实现繁琐的子查询，可以使用相关子查询实现）<br>缺点：稍难理解</p>
</li>
</ul>
<h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3><ol>
<li><p>查询各个部门最高工资的员工</p>
<ul>
<li>不相关子查询</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">select * from emp where deptno = 10 and sal = (select max(sal) from emp where deptnp = 10)</span><br><span class="line">union</span><br><span class="line">select * from emp where deptno = 20 and sal = (select max(sal) from emp where deptno = 20)</span><br><span class="line">union</span><br><span class="line">select * from emp where deptno = 30 and sal = (select max(sal) from emp where deptno = 30);</span><br></pre></td></tr></table></figure>

<p>太复杂了:unamused:</p>
<ul>
<li>相关子查询</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from emp e where sal = (select max(sal) from emp where deptno = e.deptno)</span><br></pre></td></tr></table></figure>

<p>简单多啦:happy:</p>
</li>
<li><p>查询工高于所在岗位的平均工资的那些员工</p>
<ul>
<li>不相关子查询</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select * from emp where job = &#x27;&#x27; and sal &gt;= (select avg(sal) from emp where job = &#x27;&#x27;)</span><br><span class="line">union ....</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>相关子查询</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from emp e where sal &gt;= (select avg(sal) from emp where job = e.job);</span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="数据库对象"><a href="#数据库对象" class="headerlink" title="数据库对象"></a>数据库对象</h1><h2 id="1-事务"><a href="#1-事务" class="headerlink" title="1. 事务"></a>1. 事务</h2><p><strong>事务（Transaction）</strong>是用来维护数据库完整性的，它能够保证一系列的MySQL操作要么全部执行，要么全不执行。</p>
<p>eg1.<br>转账操作：A账户要转账给B账户，那么A账户上减少的钱数和B账户上增加的钱数必须一致，也就是说A账户的转出操作和B账户的转入操作要么全部执行，要么全不执行；如果其中一个操作出现异常而没有执行的话，就会导致账户A和账户B的转入转出金额不一致的情况，为而事实上这种情况是不允许发生的，所以为了防止这种情况的发生，需要使用事务处理。<br>eg2.<br>在淘宝购物下订单的时候，商家库存要减少，订单增加记录，付款我的账号少100元…操作要么全部执行，要么全不执行</p>
<h4 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h4><p>事务（Transaction）指的是一个操作序列，该操作序列中的多个操作要么都做，要么都不做，是一个不可分割的工作单位，是数据库环境中的逻辑工作单位，由DBMS（数据库管理系统）中的事务管理子系统负责事务的处理。<br>目前常用的存储引擎有InnoDB（MySQL5.5以后默认的存储引擎）和MyISAM（MySQL5.5之前默认的存储引擎），其中InnoDB支持事务处理机制，而MyISAM不支持。</p>
<h4 id="特性"><a href="#特性" class="headerlink" title="特性"></a>特性</h4><img src="/2021/05/07/MySQL/20210703110321.png" alt="image-20210703110320474" style="zoom: 50%;">

<p>事务处理可以确保除非事务性序列内的所有操作都成功完成，否则不会永久更新面向数据的资源。通过将一组相关操作组合为一个要么全部成功要么全部失败的序列，可以简化错误恢复并使应用程序更加可靠。<br>但并不是所有的操作序列都可以称为事务，这是因为一个操作序列要成为事务，必须满足事务的原子性（Atomicity）、一致性（Consistency）、隔离性（Isolation）和持久性（Durability）。这四个特性简称为<strong>ACID特性。</strong></p>
<ol>
<li><strong>原子性</strong><pre><code>原子是自然界最小的颗粒，具有不可再分的特性。事务中的所有操作可以看做一个原子，事务是应用中不可再分的最小的逻辑执行体。
使用事务对数据进行修改的操作序列，要么全部执行，要么全不执行。通常，某个事务中的操作都具有共同的目标，并且是相互依赖的。如果数据库系统只执行这些操作中的一部分，则可能会破坏事务的总体目标，而原子性消除了系统只处理部分操作的可能性。
</code></pre>
</li>
<li><strong>一致性</strong><br>一致性是指事务执行的结果必须使数据库从一个一致性状态，变到另一个一致性状态。当数据库中只包含事务成功提交的结果时，数据库处于一致性状态。一致性是通过原子性来保证的。<br>例如：在转账时，只有保证转出和转入的金额一致才能构成事务。也就是说事务发生前和发生后，数据的总额依然匹配。</li>
<li><strong>隔离性</strong><br>隔离性是指各个事务的执行互不干扰，任意一个事务的内部操作对其他并发的事务，都是隔离的。也就是说：并发执行的事务之间既不能看到对方的中间状态，也不能相互影响。<br>例如：在转账时，只有当A账户中的转出和B账户中转入操作都执行成功后才能看到A账户中的金额减少以及B账户中的金额增多。并且其他的事务对于转账操作的事务是不能产生任何影响的。</li>
<li><strong>持久性</strong><br>持久性指事务一旦提交，对数据所做的任何改变，都要记录到永久存储器中，通常是保存进物理数据库，即使数据库出现故障，提交的数据也应该能够恢复。但如果是由于外部原因导致的数据库故障，如硬盘被损坏，那么之前提交的数据则有可能会丢失。</li>
</ol>
<h5 id="实例：使用事务保证转账安全"><a href="#实例：使用事务保证转账安全" class="headerlink" title="实例：使用事务保证转账安全"></a>实例：使用事务保证转账安全</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">-- 创建账户表：id\uname\balance</span><br><span class="line">create table account(</span><br><span class="line">        id int primary key auto_increment,</span><br><span class="line">        uname varchar(10) not null,</span><br><span class="line">        balance double</span><br><span class="line">);</span><br><span class="line">-- 查看账户表：</span><br><span class="line">select * from account;</span><br><span class="line">-- 在表中插入数据：</span><br><span class="line">insert into account values (null,&#x27;丽丽&#x27;,2000),(null,&#x27;小刚&#x27;,2000);</span><br><span class="line">-- 丽丽给小刚 转200元：</span><br><span class="line">update account set balance = balance - 200 where id = 1;</span><br><span class="line">update account set balance = balance + 200 where id = 2;</span><br><span class="line">-- 默认一个DML语句是一个事务，所以上面的操作执行了2个事务。</span><br><span class="line">update account set balance = balance - 200 where id = 1;</span><br><span class="line">update account set balance = balance2 + 200 where id = 2;</span><br></pre></td></tr></table></figure>

<p><strong>必须让上面的两个操作控制在一个事务中</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-- 手动开启事务：</span><br><span class="line">start transaction;</span><br><span class="line">-- 操作：</span><br><span class="line">update account set balance = balance - 200 where id = 1;</span><br><span class="line">update account set balance = balance + 200 where id = 2;</span><br><span class="line">-- 手动回滚：刚才执行的操作全部取消：</span><br><span class="line">rollback;</span><br><span class="line">-- 手动提交：</span><br><span class="line">commit;</span><br></pre></td></tr></table></figure>

<p>在<strong>回滚和提交</strong>之前，数据库中的数据都是操作的缓存中的数据，而不是数据库的真实数据</p>
<h3 id="事务并发问题"><a href="#事务并发问题" class="headerlink" title="事务并发问题"></a>事务并发问题</h3><h5 id="脏读（Dirty-read）"><a href="#脏读（Dirty-read）" class="headerlink" title="脏读（Dirty read）"></a>脏读（Dirty read）</h5><p>当一个事务正在访问数据并且对数据进行了修改，而这种修改还没有提交到数据库中，这时另外一个事务也访问了这个数据，然后使用了这个数据。因为这个数据是还没有提交的数据，那么另外一个事务读到的这个数据是“脏数据”，依据“脏数据”所做的操作可能是不正确的。</p>
<img src="/2021/05/07/MySQL/20210703111005.png" alt="image-20210703111005503" style="zoom:67%;">

<h5 id="不可重复读-（Unrepeatableread）"><a href="#不可重复读-（Unrepeatableread）" class="headerlink" title="不可重复读 （Unrepeatableread）"></a>不可重复读 （Unrepeatableread）</h5><p>指在一个事务内多次读同一数据。在这个事务还没有结束时，另一个事务也访问该数据。那么，在第一个事务中的两次读数据之间，由于第二个事务的修改导致第一个事务两次读取的数据可能不太一样。这就发生了在一个事务内两次读到的数据是不一样的情况，因此称为不可重复读。</p>
<img src="/2021/05/07/MySQL/20210703111018.png" alt="image-20210703111018492" style="zoom:67%;">

<h5 id="幻读-（Phantom-read）"><a href="#幻读-（Phantom-read）" class="headerlink" title="幻读 （Phantom read）"></a>幻读 （Phantom read）</h5><p>幻读与不可重复读类似。它发生在一个事务（T1）读取了几行数据，接着另一个并发事务（T2）插入了一些数据时。在随后的查询中，第一个事务（T1）就会发现多了一些原本不存在的记录，就好像发生了幻觉一样，所以称为幻读。</p>
 <img src="/2021/05/07/MySQL/20210703111036.png" alt="image-20210703111036154" style="zoom:67%;">

<p><strong>不可重复度和幻读区别：</strong> </p>
<p>不可重复读的重点是修改，幻读的重点在于新增或者删除。解决不可重复读的问题只需锁住满足条件的行，解决幻读需要锁表 。</p>
<p>例1（同样的条件, 你读取过的数据, 再次读取出来发现值不一样了 ）：事务1中的A先生读取自己的工资为 1000的操作还没完成，事务2中的B先生就修改了A的工资为2000，导 致A再读自己的工资时工资变为 2000；这就是不可重复读。</p>
<p>例2（同样的条件, 第1次和第2次读出来的记录数不一样 ）：假某工资单表中工资大于3000的有4人，事务1读取了所有工资大于3000的人，共查到4条记录，这时事务2 又插入了一条工资大于3000的记录，事务1再次读取时查到的记录就变为了5条，这样就导致了幻读 </p>
<h3 id="事务隔离级别"><a href="#事务隔离级别" class="headerlink" title="事务隔离级别"></a>事务隔离级别</h3><p>​    事务的隔离级别用于决定如何控制并发用户读写数据的操作。数据库是允许多用户并发访问的，如果多个用户同时开启事务并对同一数据进行读写操作的话，有可能会出现脏读、不可重复读和幻读问题，所以MySQL中提供了四种隔离级别来解决上述问题。</p>
<p>​    从低到高依次为<strong>READ UNCOMMITTED、READ COMMITTED、REPEATABLE READ以及SERIALIZABLE</strong>，隔离级别越低，越能支持高并发的数据库操作。      </p>
<img src="/2021/05/07/MySQL/20210703142738.png" alt="image-20210703142738514" style="zoom:67%;">                        

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-- 查看默认的事务隔离级别  MySQL默认的是repeatable read  </span><br><span class="line">select @@transaction_isolation;  </span><br><span class="line">-- 设置事务的隔离级别   （设置当前会话的隔离级别）</span><br><span class="line">set session transaction isolation level read uncommitted;  </span><br><span class="line">set session transaction isolation level read committed;  </span><br><span class="line">set session transaction isolation level repeatable read;  -- 默认的</span><br><span class="line">set session transaction isolation level serializable;  </span><br><span class="line">start transaction ;</span><br><span class="line">select * from account where id = 1;</span><br></pre></td></tr></table></figure>

<h5 id="实例-1"><a href="#实例-1" class="headerlink" title="实例"></a>实例</h5><p>（必须是两个事务都开始以后执行的操作才会影响）</p>
<ul>
<li><p>在read uncommitted的情况下，开始两个事务：</p>
<ul>
<li>事务一</li>
</ul>
<img src="/2021/05/07/MySQL/20210703152258.png" alt="image-20210703145526739" style="zoom:67%;">

<ul>
<li>事务二</li>
</ul>
<img src="/2021/05/07/MySQL/05/07/MySQL/20210703152314.png" class title="image-20210703145443742"></li>
<li><p>事务一查询操作：</p>
<img src="/2021/05/07/MySQL/20210703152514.png" alt="image-20210703152514123" style="zoom:67%;"></li>
<li><p>事务二更新操作，且没提交</p>
<img src="/2021/05/07/MySQL/20210703152552.png" alt="image-20210703152552191" style="zoom:67%;"></li>
<li><p>事务一再次查询：</p>
<img src="/2021/05/07/MySQL/20210703152939.png" alt="image-20210703152939898" style="zoom:67%;">

<p>读到了在脏数据</p>
</li>
<li><p>如果设置为</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set session transaction isolation level read committed;</span><br></pre></td></tr></table></figure>

<p>事务二就不会读到脏数据。</p>
</li>
</ul>
<h2 id="2-视图"><a href="#2-视图" class="headerlink" title="2. 视图"></a>2. 视图</h2><h4 id="概念-1"><a href="#概念-1" class="headerlink" title="概念"></a>概念</h4><p>视图（view）是一个从单张或多张基础数据表或其他视图中构建出来的虚拟表。同基础表一样，视图中也包含了一系列带有名称的列和行数据，但是数据库中只是存放视图的定义，也就是动态检索数据的查询语句，而并不存放视图中的数据，这些数据依旧存放于构建视图的基础表中，只有当用户使用视图是才去数据库请求相对应的数据，即视图中的数据是在引用视图时动态生成的。因此视图中的数据发生了变化，视图中相应的数据也会跟着改变。</p>
<p>PS：视图本质上就是：一个查询语句，是一个虚拟的表，不存在的表，你查看视图，其实就是查看视图对应的sql语句。</p>
<h4 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h4><p>简化用户操作：视图可以使用户将注意力集中在所关心地数据上，而不需要关心数据表的结构、与其他表的关联条件以及查询条件等。</p>
<p>对机密数据提供安全保护：有了视图，就可以在设计数据库应用系统时，对不同的用户定义不同的视图，避免机密数据（如，敏感字段“salary”）出现在不应该看到这些数据的用户视图上。这样视图就自动提供了对机密数据的安全保护功能</p>
<h4 id="实例一：单表视图"><a href="#实例一：单表视图" class="headerlink" title="实例一：单表视图"></a>实例一：单表视图</h4><ul>
<li><p>创建/替换单表视图：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-- 创建/替换单表视图：</span><br><span class="line">create or replace view myview01</span><br><span class="line">as</span><br><span class="line">select empno,ename,job,deptno </span><br><span class="line">from emp</span><br><span class="line">where deptno = 20</span><br></pre></td></tr></table></figure></li>
<li><p>查看视图：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 查看视图：</span><br><span class="line">select * from myview01;</span><br></pre></td></tr></table></figure></li>
<li><p>向视图中插入满足条件的数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 在视图中插入数据：</span><br><span class="line">insert into myview01 (empno,ename,job,deptno) values (9999,&#x27;lili&#x27;,&#x27;CLERK&#x27;,20);</span><br></pre></td></tr></table></figure>

<p>查看视图：</p>
<img src="/2021/05/07/MySQL/20210703161609.png" alt="image-20210703161609044" style="zoom:67%;"></li>
<li><p>向视图中插入不满足条件的数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">insert into myview01 (empno,ename,job,deptno) values (8888,&#x27;nana&#x27;,&#x27;CLERK&#x27;,30);</span><br></pre></td></tr></table></figure>

<p>查看原来的表，发现成功插进去了</p>
<img src="/2021/05/07/MySQL/20210703161731.png" alt="image-20210703161731377" style="zoom:67%;"></li>
<li><p>解决上面问题：</p>
<p>需要加上<strong>check option</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-- 创建/替换单表视图：</span><br><span class="line">create or replace view myview01</span><br><span class="line">as</span><br><span class="line">select empno,ename,job,deptno </span><br><span class="line">from emp</span><br><span class="line">where deptno = 20</span><br><span class="line">with check option;</span><br></pre></td></tr></table></figure>

<p>这样不满足条件的数据就不会轻易被加进去：</p>
<img src="/2021/05/07/MySQL/20210703162005.png" alt="image-20210703162005163" style="zoom:67%;"></li>
</ul>
<h4 id="实例二：多表视图"><a href="#实例二：多表视图" class="headerlink" title="实例二：多表视图"></a>实例二：多表视图</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-- 创建/替换多表视图：</span><br><span class="line">create or replace view myview02</span><br><span class="line">as </span><br><span class="line">select e.empno,e.ename,e.sal,d.deptno,d.dname</span><br><span class="line">from emp e</span><br><span class="line">join dept d</span><br><span class="line">on e.deptno = d.deptno</span><br><span class="line">where sal &gt; 2000 ;</span><br><span class="line">select * from myview02;</span><br></pre></td></tr></table></figure>

<h4 id="实例三：统计视图"><a href="#实例三：统计视图" class="headerlink" title="实例三：统计视图"></a>实例三：统计视图</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-- 创建统计视图：</span><br><span class="line">create or replace view myview03</span><br><span class="line">as</span><br><span class="line">select e.deptno,d.dname,avg(sal),min(sal),count(1)</span><br><span class="line">from emp e</span><br><span class="line">join dept d</span><br><span class="line">using(deptno)</span><br><span class="line">group by e.deptno ;</span><br><span class="line">select * from myview03;</span><br></pre></td></tr></table></figure>

<h4 id="实例四：基于视图的视图"><a href="#实例四：基于视图的视图" class="headerlink" title="实例四：基于视图的视图"></a>实例四：基于视图的视图</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-- 创建基于视图的视图：</span><br><span class="line">create or replace view myview04</span><br><span class="line">as</span><br><span class="line">select * from myview03 where deptno = 20;</span><br><span class="line">select * from myview04;</span><br></pre></td></tr></table></figure>



<h2 id="3-存储过程"><a href="#3-存储过程" class="headerlink" title="3. 存储过程"></a>3. 存储过程</h2><h4 id="概念-2"><a href="#概念-2" class="headerlink" title="概念"></a>概念</h4><ul>
<li><p>通过前面章节的学习，我们已经知道SQL是一种非常便利的语言。从数据库抽取数据，或者对特定的数据集中更新时，都能通过简洁直观的代码实现。</p>
</li>
<li><p>但是这个所谓的“简洁”也是有限制，SQL基本是一个命令实现一个处理，是所谓的非程序语言。</p>
</li>
<li><p>在不能编写流程的情况下，所有的处理只能通过一个个命令来实现。当然，通过使用连接及子查询，即使使用SQL的单一命令也能实现一些高级的处理，但是，其局限性是显而易见的。例如，在SQL中就很难实现针对不同条件进行不同的处理以及循环等功能。</p>
</li>
<li><p>这个时候就出现了存储过程这个概念，简单地说，存储过程就是数据库中保存(Stored)的一系列SQL命令（Procedure）的集合。也可以将其看作相互之间有关系的SQL命令组织在一起形成的一个小程序。</p>
</li>
</ul>
<h4 id="优点-1"><a href="#优点-1" class="headerlink" title="优点"></a>优点</h4><ul>
<li> 提高执行性能。存储过程执行效率之所高，在于普通的SQL语句，每次都会对语法分析，编译，执行，而存储过程只是在第一次执行语法分析，编译，执行，以后都是对结果进行调用。</li>
<li> 可减轻网络负担。使用存储过程，复杂的数据库操作也可以在数据库服务器中完成。只需要从客户端(或应用程序)传递给数据库必要的参数就行，比起需要多次传递SQL命令本身，这大大减轻了网络负担。</li>
<li> 可将数据库的处理黑匣子化。应用程序中完全不用考虑存储过程的内部详细处理，只需要知道调用哪个存储过程就可以了</li>
</ul>
<h4 id="实例-2"><a href="#实例-2" class="headerlink" title="实例"></a>实例</h4><ul>
<li><p>定义一个没有返回值的存储过程</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">-- 定义一个没有返回值 存储过程</span><br><span class="line">-- 实现：模糊查询操作：</span><br><span class="line">select * from emp where ename like &#x27;%A%&#x27;;</span><br><span class="line">create procedure mypro01(name varchar(10))</span><br><span class="line">begin</span><br><span class="line">        if name is null or name = &quot;&quot; then</span><br><span class="line">                select * from emp; -- 传入null，就查看全表</span><br><span class="line">        else</span><br><span class="line">    select * from emp where ename like concat(&#x27;%&#x27;,name,&#x27;%&#x27;); </span><br><span class="line">        end if;	</span><br><span class="line">end;</span><br><span class="line">-- 删除存储过程：</span><br><span class="line">drop procedure mypro01;</span><br><span class="line">-- 调用存储过程：</span><br><span class="line">call mypro01(null);</span><br><span class="line">call mypro01(&#x27;R&#x27;);</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<img src="/2021/05/07/MySQL/20210703171452.png" alt="image-20210703171452630" style="zoom: 50%;"></li>
<li><p>定义一个有返回值的存储过程</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">-- 定义一个有返回值的存储过程</span><br><span class="line">-- in 参数前面的in可以不写</span><br><span class="line">-- out </span><br><span class="line">-- found_rows() 是mysql定义的一个函数，作用返回查询结果的条数</span><br><span class="line">-- into </span><br><span class="line">create procedure mypro02 (in name varchar(10),out num int(4))</span><br><span class="line">begin </span><br><span class="line">		if name is null or name = &quot;&quot; then</span><br><span class="line">				select * from emp;</span><br><span class="line">		else </span><br><span class="line">				select * from emp where name like concat(&#x27;%&#x27;,name,&#x27;%&#x27;);</span><br><span class="line">		end if;</span><br><span class="line">		select found_rows() into num;</span><br><span class="line">end;</span><br><span class="line">-- 调用存储过程</span><br><span class="line">call mypro02(null,@num);</span><br><span class="line">select @num;</span><br><span class="line">call mypro02(&#x27;A&#x27;,@aaa); -- 传入的参数名不一定要一样</span><br><span class="line">select @aaa;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<img src="/2021/05/07/MySQL/20210703191518.png" alt="image-20210703191518417" style="zoom:67%;"></li>
</ul>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="followme">
  <span>欢迎关注我的其它发布渠道</span>

  <div class="social-list">

      <div class="social-item">
        <a target="_blank" class="social-link" href="https://blog.csdn.net/weixin_43633620?spm=1000.2115.3001.5343">
          <span class="icon">
            <i class="fab fa-twitter"></i>
          </span>

          <span class="label">CSDN</span>
        </a>
      </div>

      <div class="social-item">
        <a target="_blank" class="social-link" href="/images/wechat.jpg">
          <span class="icon">
            <i class="fab fa-weixin"></i>
          </span>

          <span class="label">WeChat</span>
        </a>
      </div>

      <div class="social-item">
        <a target="_blank" class="social-link" href="/atom.xml">
          <span class="icon">
            <i class="fa fa-rss"></i>
          </span>

          <span class="label">RSS</span>
        </a>
      </div>
  </div>
</div>

          <div class="post-tags">
              <a href="/tags/DataBase/" rel="tag"># DataBase</a>
              <a href="/tags/MySQL/" rel="tag"># MySQL</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
            </div>
            <div class="post-nav-item">
                <a href="/2021/06/07/JDBC/" rel="next" title="JDBC">
                  JDBC <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Sonia33</span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

<script color="0,0,255" opacity="0.5" zIndex="-1" count="99" src="https://cdn.jsdelivr.net/npm/canvas-nest.js@1/dist/canvas-nest.js"></script>

<div>
<span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span>
<script>
    var now = new Date();
    function createtime() {
        var grt= new Date("6/5/2022 17:00:00");
        now.setTime(now.getTime()+250);
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days);
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours);
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;}
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;}
        document.getElementById("timeDate").innerHTML = "本站已安全运行 "+dnum+" 天 ";
        document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒";
    }
setInterval("createtime()",250);
</script>
</div>
    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  
<script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>





  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




<div class="moon-menu">
  <div class="moon-menu-items">
    
    <div id="moon-menu-item-back2bottom" class="moon-menu-item">
      <i class='fas fa-chevron-down'></i>    </div>
    
    <div id="moon-menu-item-back2top" class="moon-menu-item">
      <i class='fas fa-chevron-up'></i>    </div>
    
  </div>
  <div class="moon-menu-button">
    <svg class="moon-menu-bg">
      <circle class="moon-menu-cricle" cx="50%" cy="50%" r="44%"></circle>
      <circle class="moon-menu-border" cx="50%" cy="50%" r="48%"></circle>
    </svg>
    <div class="moon-menu-content">
      <div class="moon-menu-icon"><i class='fas fa-ellipsis-v'></i></div>
      <div class="moon-menu-text"></div>
    </div>
  </div>
</div><script src="/js/injector.js"></script>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"model":{"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"position":"left","width":150,"height":300},"mobile":{"show":true},"log":false});</script><script async>window.onload=function(){var a=document.createElement('script'),b=document.getElementsByTagName('script')[0];a.type='text/javascript',a.async=!0,a.src='/sw-register.js?v='+Date.now(),b.parentNode.insertBefore(a,b)};</script></body></html>